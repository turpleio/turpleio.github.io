<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=3">
<meta httpequiv="x-ua-compatible" content="ie=edge">
<meta property="og:type" content="website">
<meta name="author" content="turpleio">
<meta name="generator" content="Docusaurus v2.0.0-alpha.75">
<link href="https://www.googletagmanager.com" rel="dns-prefetch">
<link href="https://www.google-analytics.com" rel="dns-prefetch">
<link rel="icon" href="/favicon.png">
<link rel="apple-touch-icon" href="/img/icons/apple-180x180.png" sizes="180x180">
<meta name="msapplication-config" content="/browserconfig.xml">
<link rel="sitemap" type="application/xml" href="/sitemap.xml">
<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=GTM-PVR7M2G"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","GTM-PVR7M2G",{anonymize_ip:!0})</script>
<link rel="search" type="application/opensearchdescription+xml" title="Turple: Cloud Native Platform" href="/opensearch.xml">
<link rel="manifest" href="/manifest.webmanifest">
<meta name="theme-color" content="#d14671">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#21222c">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Turple: Cloud Native Platform Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Turple: Cloud Native Platform Blog Atom Feed"><title data-react-helmet="true">Exploring cryptocurrency prices with QuestDB and Google Data Studio | Turple: Cloud Native Platform</title><meta data-react-helmet="true" property="og:title" content="Exploring cryptocurrency prices with QuestDB and Google Data Studio | Turple: Cloud Native Platform"><meta data-react-helmet="true" name="description" content="Visualizing historical prices of Ethereum, Cardano, and Solana by ingesting data into QuestDB and graphing price trends on Google Data Studio. records on the fly."><meta data-react-helmet="true" name="twitter:description" content="Visualizing historical prices of Ethereum, Cardano, and Solana by ingesting data into QuestDB and graphing price trends on Google Data Studio. records on the fly."><meta data-react-helmet="true" property="og:description" content="Visualizing historical prices of Ethereum, Cardano, and Solana by ingesting data into QuestDB and graphing price trends on Google Data Studio. records on the fly."><meta data-react-helmet="true" name="twitter:title" content="Exploring cryptocurrency prices with QuestDB and Google Data Studio | Turple: Cloud Native Platform"><meta data-react-helmet="true" name="twitter:image:alt" content="Image for &quot;Exploring cryptocurrency prices with QuestDB and Google Data Studio | Turple: Cloud Native Platform&quot;"><meta data-react-helmet="true" name="keywords" content="timeseries,crypto,ethereum,solana,kaggle,googlecloud,marketdata"><meta data-react-helmet="true" property="og:image" content="https://turpleio.github.io/img/blog/shared/og-solana-eth.png"><meta data-react-helmet="true" name="twitter:image" content="https://turpleio.github.io/img/blog/shared/og-solana-eth.png"><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><link rel="stylesheet" href="/assets/css/styles.4f6557e4.css">
</head>
<body itemscope itemtype="http://schema.org/Organization">
<meta itemprop="name" content="Turple: Cloud Native Platform">
<meta itemprop="description" content="Turple is a cloud native platform which can help you build and operate your services on cloud.">
<meta itemprop="url" content="https://turpleio.github.io">
<meta itemprop="logo" content="https://turpleio.github.io/img/favicon.png">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}()</script><div id="__docusaurus">
<nav class="navbar navbar_wBc8 navbar--light"><div class="navbar__inner inner_Y8Z6"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand brand_AtiA" href="/">QuestDB</a></div><div class="navbar__items navbar__items--right"></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand brand_AtiA" href="/">QuestDB</a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"></ul></div></div></div></nav><div class="wrapper_DIJ0 blog-wrapper"><div class="container margin-vert--lg"><div class="row"><div class="col col--3"><div class="sidebar_q+wC thin-scrollbar"><h3 class="sidebarItemTitle_9G5K">Recent posts</h3><ul class="sidebarItemList_6T4b"><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/blog/2022/12/19/merry-questmas-gifts-2023">Merry Questmas! Here are your gifts for 2023...</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/blog/2022/12/13/using-prometheus-loki-grafana-monitor-questdb-kubernetes">Using Prometheus, Loki, and Grafana to monitor QuestDB in Kubernetes</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/blog/2022/11/30/full-table-scan-are-fast">Listen to Your CPU - Full-table Scans Are Fast</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/blog/2022/11/25/questdb-6.6.1-dynamic-commits">QuestDB 6.6.1 - Dynamic Commits</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/blog/2022/11/23/sql-extensions-time-series-data-questdb-part-ii">SQL Extensions for Time Series Data in QuestDB - Part II</a></li></ul></div></div><main class="col col--7"><article><header><h1 class="title_KBQu">Exploring cryptocurrency prices with QuestDB and Google Data Studio</h1><time datetime="2022-02-10T00:00:00.000Z" class="date_A31P">February 10, 2022 Â· 5 min read</time><div class="avatar margin-vert--md"><a href="https://github.com/Yitaek" target="_blank" rel="noopener noreferrer" class="avatar__photo-link avatar__photo"><img src="https://avatars.githubusercontent.com/Yitaek" alt="Yitaek Hwang"></a><div class="avatar__intro"><h4 class="avatar__name"><a href="https://github.com/Yitaek" target="_blank" rel="noopener noreferrer">Yitaek Hwang</a></h4><small class="avatar__subtitle">Guest</small></div></div></header><div class="markdown"><figure><img alt="A series of logos of popular cryptocurrencies" class="image_Pw1y margin_Rc0b shadow_7z-4" height="385" src="/img/blog/2022-02-10/banner.png" width="850"></figure><p>Various crypto market research websites such as
<a href="https://glassnode.com/" target="_blank" rel="noopener noreferrer">Glassnode</a>, <a href="https://messari.io/" target="_blank" rel="noopener noreferrer">Messari</a>, and
<a href="https://www.tradingview.com/" target="_blank" rel="noopener noreferrer">TradingView</a> provide free and easy ways to
analyze market trends. However, not all the advanced charting functions are
available for free, with some of the best features locked behind a paywall. If
you want to explore these datasets using open-source and free alternatives, you
can quickly get started in less than 5 minutes of setup.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="prerequisites"></a>Prerequisites<a class="hash-link" href="#prerequisites" title="Direct link to heading">#</a></h2><ul><li><a href="https://console.cloud.google.com" target="_blank" rel="noopener noreferrer">Google Cloud</a> account</li><li><a href="https://cloud.google.com/sdk/docs/install" target="_blank" rel="noopener noreferrer">gcloud sdk</a></li><li><a href="https://helm.sh/docs/intro/install/" target="_blank" rel="noopener noreferrer">Helm 3</a></li><li><a href="https://www.kaggle.com/" target="_blank" rel="noopener noreferrer">Kaggle</a> account</li><li><strong>Optional:</strong> <a href="https://developers.coinbase.com/" target="_blank" rel="noopener noreferrer">Coinbase API</a> access</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="building-a-dataset-of-cryptocurrency-prices"></a>Building a dataset of cryptocurrency prices<a class="hash-link" href="#building-a-dataset-of-cryptocurrency-prices" title="Direct link to heading">#</a></h2><p>In this tutorial, we will use the precompiled dataset of cryptocurrency prices
from Kaggle, but if you would like to build your own dataset, see our
<a href="/blog/2021/02/18/realtime-crypto-tracker-with-kafka-and-questdb">Realtime crypto tracker</a>
tutorial that uses Kafka and QuestDB.</p><p>The
<a href="https://www.kaggle.com/sudalairajkumar/cryptocurrencypricehistory" target="_blank" rel="noopener noreferrer">Cryptocurrency Historical Prices</a>
dataset on Kaggle provides a compiled list of cryptocurrency prices pulled from
<a href="https://coinmarketcap.com/" target="_blank" rel="noopener noreferrer">CoinMarketCap</a>. Log in or create a free Kaggle
account to download the various .CSV files of coin prices over time. Since the
overarching narrative in 2021 was the emergence of layer 1 protocols, I will
look at Ethereum, Cardano, and Solana datasets.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="google-data-studio-setup"></a>Google Data Studio setup<a class="hash-link" href="#google-data-studio-setup" title="Direct link to heading">#</a></h2><p>Although Google Data Studio can connect to any publicly-accessible PostgreSQL
endpoint, Iâll be using Google Cloud since Iâve written about running
<a href="/blog/2021/03/18/questdb-and-prometheus-on-gke-autopilot">QuestDB on GKE Autopilot</a>
before. In your Google Cloud account:</p><ul><li>Navigate to
<a href="https://console.cloud.google.com/kubernetes" target="_blank" rel="noopener noreferrer">Google Kubernetes Engine</a></li><li>Enable the Kubernetes Engine API</li><li>Click on <strong>Create Cluster</strong> (youâll need to have a billing account added)</li></ul><p>For this demo, I decided to use the <strong>Standard mode</strong> with one node in
<code>us-east1-c</code> region with other default settings accepted:</p><figure><img alt="Creating a QuestDB cluster using GKE on Google Cloud" class="image_Pw1y margin_Rc0b shadow_7z-4" height="385" src="/img/blog/2022-02-10/create_cluster.png" width="650"></figure><p>Once the cluster is created, fetch the cluster credentials via the <code>gcloud</code> CLI
to authenticate:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI bash"><div tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#f8f8f2;background-color:#262833"><div class="token-line" style="color:#f8f8f2"><span class="token plain">$ gcloud container clusters </span><span class="token punctuation" style="color:#f8f8f2">\</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  get-credentials cluster-1 --zone us-east1-c --project </span><span class="token operator" style="color:#ff79c6">&lt;</span><span class="token plain">project-id</span><span class="token operator" style="color:#ff79c6">&gt;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="running-questdb-on-gke-using-helm"></a>Running QuestDB on GKE using Helm<a class="hash-link" href="#running-questdb-on-gke-using-helm" title="Direct link to heading">#</a></h2><p>QuestDB provides an <a href="/docs/deployment/kubernetes">official Helm chart</a> that deploys
a single <code>StatefulSet</code> pod with 50Gi PVC by default. To make the PostgreSQL wire
endpoint accessible by Google Data Studio, we need to modify the service type
and set the expose field to <code>true</code>. Create a new <code>values.yaml</code> file with the
following contents:</p><div class="codeBlockContainer_J+bg"><div style="color:#f8f8f2;background-color:#262833" class="codeBlockTitle_oQzk">values.yaml</div><div class="codeBlockContent_csEI yaml"><div tabindex="0" class="prism-code language-yaml codeBlock_rtdJ thin-scrollbar codeBlockWithTitle_ZT05"><div class="codeBlockLines_1zSZ" style="color:#f8f8f2;background-color:#262833"><div class="token-line" style="color:#f8f8f2"><span class="token key atrule">service</span><span class="token punctuation" style="color:#f8f8f2">:</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token key atrule">type</span><span class="token punctuation" style="color:#f8f8f2">:</span><span class="token plain"> LoadBalancer</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token key atrule">expose</span><span class="token punctuation" style="color:#f8f8f2">:</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token key atrule">postgresql</span><span class="token punctuation" style="color:#f8f8f2">:</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token key atrule">enabled</span><span class="token punctuation" style="color:#f8f8f2">:</span><span class="token plain"> </span><span class="token boolean important" style="color:#bd93f9">true</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>Then deploy to our GKE cluster:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI bash"><div tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#f8f8f2;background-color:#262833"><div class="token-line" style="color:#f8f8f2"><span class="token plain">$ helm repo </span><span class="token function" style="color:#8be9fd">add</span><span class="token plain"> questdb https://helm.questdb.io/</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">$ helm upgrade -i questdb questdb/questdb -f values.yaml</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>Wait for the pod to become healthy and provision a load balancer:</p><figure><img alt="Viewing the state of a QuestDB cluster on Google Cloud Platform" class="image_Pw1y margin_Rc0b shadow_7z-4" height="385" src="/img/blog/2022-02-10/load_balancer.png" width="650"></figure><p>Under Kubernetes Engine &gt; Services &amp; Ingress, check the IP address of the
QuestDB service. There is a link which you can follow to port <code>9000</code> which will
bring you to the web UI for QuestDB. To insert data, click the <strong>Upload</strong> icon
on the left-hand panel and import the CSV data:</p><figure><img alt="Importing cryptocurrency data via CSV upload in QuestDB&#x27;s web UI" class="image_Pw1y margin_Rc0b shadow_7z-4" height="385" src="/img/blog/2022-02-10/import_csv.png" width="1000"></figure><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="working-with-google-data-studio"></a>Working with Google Data Studio<a class="hash-link" href="#working-with-google-data-studio" title="Direct link to heading">#</a></h2><p>Navigate to the <a href="https://datastudio.google.com" target="_blank" rel="noopener noreferrer">Google Data Studio dashboard</a>
and click on <strong>Create &gt; Report</strong>. This will automatically bring up an <strong>Add data
to report</strong> tab where we can select PostgreSQL. This tab is where you will need
to fill out the IP address of the external load balancer provisioned by GKE as
well as the default port and credentials:</p><figure><img alt="Authenticating with QuestDB via Google Data Studio" class="image_Pw1y margin_Rc0b shadow_7z-4" height="385" src="/img/blog/2022-02-10/db_auth.png" width="300"></figure><p>Google will treat <strong>each table</strong> as a data source, so youâll have to import each
table separately. By default, Data Studio will create a default table with
<code>Symbol</code> and <code>Record</code> Count:</p><figure><img alt="Mapping table schema in Google Data Studio" class="image_Pw1y margin_Rc0b shadow_7z-4" height="385" src="/img/blog/2022-02-10/schema.png" width="400"></figure><p>You can modify the Dimension to add the other fields such as <code>Marketcap</code>,
<code>High</code>, <code>Low</code>, etc:</p><figure><img alt="A QuestDB table with multiple columns in Google Data Studio" class="image_Pw1y margin_Rc0b shadow_7z-4" height="385" src="/img/blog/2022-02-10/dimensions.png" width="600"></figure><p>The default Date format Google Data Studio uses is not compatible with QuestDB
as it uses the
<a href="https://github.com/questdb/questdb/issues/1818" target="_blank" rel="noopener noreferrer">PostgreSQL DATE_TRUNC</a> function
that is not yet supported. Click on <strong>Resource &gt; Manage added data sources</strong> and
change the Date format to <code>ISO Year Week</code>. This way, it&#x27;s possible to create a
coarse timeseries chart of Marketcap over time:</p><figure><img alt="A timeseries chart showing cryptocurrency market cap over time" class="image_Pw1y margin_Rc0b shadow_7z-4" height="385" src="/img/blog/2022-02-10/marketcap.png" width="600"></figure><p>You can also add multiple dimensions to check how the market opened, what the
highest price of the day was as opposed to the lowest price:</p><figure><img alt="A timeseries chart showing multiple cryptocurrency market caps over time" class="image_Pw1y margin_Rc0b shadow_7z-4" height="385" src="/img/blog/2022-02-10/multiple_dimensions.png" width="600"></figure><p>The graphing capabilities are not especially advanced with Data Studio, so
support for candlesticks and other common financial charts are not available,
but you can import multiple data sources to compare the price of Cardano vs.
Solana over similar time period:</p><figure><img alt="A timeseries chart showing Cardano versus Solana market caps over time" class="image_Pw1y margin_Rc0b shadow_7z-4" height="385" src="/img/blog/2022-02-10/cardano_solana.png" width="600"></figure><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="next-steps"></a>Next steps<a class="hash-link" href="#next-steps" title="Direct link to heading">#</a></h2><p>Right now QuestDB does not natively support SSL connections. To enable SSL, we
can use PgBouncer to secure Google Data Studio to
<a href="https://www.pgbouncer.org/" target="_blank" rel="noopener noreferrer">PgBouncer</a> and leverage a service mesh inside
Kubernetes to secure PgBouncer to QuestDB. You can also put QuestDB behind a
firewall and only whitelist the
<a href="https://support.google.com/datastudio/answer/7288010?hl=en#zippy=%2Cin-this-article" target="_blank" rel="noopener noreferrer">IPs that Data Studio uses</a>
to access the database.</p><p>Google Data Studio might be lacking for serious data analysis needs beyond
simple visualizations and auto-aggregations. When we&#x27;re making more complicated
analyses, we will connect QuestDB directly to a Jupyter Notebook to explore our
data in more detail using Pandas.</p></div><footer class="row margin-vert--lg"><div class="col"><strong>Tags:</strong><a class="margin-horiz--sm" href="/blog/tags/tutorial">tutorial</a><a class="margin-horiz--sm" href="/blog/tags/crypto">crypto</a><a class="margin-horiz--sm" href="/blog/tags/googlecloud">googlecloud</a><a class="margin-horiz--sm" href="/blog/tags/market-data">market data</a><a class="margin-horiz--sm" href="/blog/tags/autopilot">autopilot</a></div></footer></article><div></div><div class="margin-vert--xl"><nav class="pagination-nav" aria-label="Blog post page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/blog/2022/03/07/calling-on-our-community-members"><div class="pagination-nav__sublabel">Newer Post</div><div class="pagination-nav__label">Â« Calling on our community members to help us support Ukraine</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/blog/2022/02/02/order-flow-imbalance"><div class="pagination-nav__sublabel">Older Post</div><div class="pagination-nav__label">Order Flow Imbalance - A High Frequency Trading Signal Â»</div></a></div></nav></div></main></div></div><div class="root_0lLS"><div class="cards_xeZk"><div class="root_R798 skinPrimary_JHOH"><svg width="76" height="76" viewBox="0 0 76 76" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="38" cy="38" r="38" fill="#1E1F27"></circle><path d="M56.99 18.792a.817.817 0 00-.117-.303c-.01-.02-.02-.05-.03-.069-.01-.02-.029-.029-.048-.049a.912.912 0 00-.137-.136l-.117-.088c-.02-.01-.03-.03-.05-.04-.029-.01-.068-.029-.107-.039a.85.85 0 00-.146-.049 1.075 1.075 0 00-.176-.019h-.147a1.15 1.15 0 00-.196.049c-.029.01-.068.01-.097.02L12.59 36.67a.979.979 0 00-.509 1.29c.098.216.264.401.48.5l16.07 7.556v15.025c0 .537.44.977.978.977a.964.964 0 00.831-.469l6.794-11.046 10.499 5.533a.974.974 0 001.408-.655l7.84-36.2v-.058c.01-.058.01-.107.019-.156 0-.059 0-.117-.01-.176zM29.413 44.208L15.376 37.6l36.326-15.68-22.289 22.288zm1.174 13.363V47.004l4.917 2.59-4.917 7.977zm16.92-3.87l-9.237-4.86-1.662-1.026-.068.118-5.289-2.786 23.1-23.12L47.508 53.7z" fill="#fff"></path></svg><h3 class="title_BHe0">ë¬¸ìíê¸°</h3><p class="description_Bwvi">ì´ë©ì¼ì ìë ¥íìë©´ ìê°ìë£ë¥¼ ë³´ë´ëë¦½ëë¤.</p><div class="content_gAr2"><form class="root_teCd"><div><div class="inputs_0wQ8"><input type="email" class="input_cjQx input_a6pP" name="email" required="" pattern="^[a-zA-Z0-9.!#$%&amp;&#x27;*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+$" placeholder="Email address" title="Email address should be valid"><button class="submit_poRs button_f7Ff button--tertiary_vtfp button--uppercase_ESEN" type="submit">ë³´ë´ê¸°</button></div></div></form></div></div></div></div></div><footer class="root_JnvJ"><div class="content_-gfC center_S24y"><img alt="QuestDB logo" class="logo_JrwJ" src="/img/navbar/tp_brand.png" width="108" height="27"><div class="tagline_T1tH"><p>ì¸íë¼ê´ë¦¬ë¶í° ìë¹ì¤ì´ìê¹ì§ í´ë¼ì°ëíê²½ì ìµì íë í´ë¼ì°ë ë¤ì´í°ë¸ íë«í¼</p></div><div class="links_1SgP"></div></div><div class="border_PW0V"><div class="bottom_wPs3 center_S24y">Copyright Â© 2023 Gitple. All rights are reserved.</div></div></footer></div>
<script src="/assets/js/main.e53824dd.js" defer="defer"></script>
</body>
</html>