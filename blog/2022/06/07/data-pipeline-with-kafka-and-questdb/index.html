<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=3">
<meta httpequiv="x-ua-compatible" content="ie=edge">
<meta property="og:type" content="website">
<meta name="author" content="turpleio">
<meta name="generator" content="Docusaurus v2.0.0-alpha.75">
<link href="https://www.googletagmanager.com" rel="dns-prefetch">
<link href="https://www.google-analytics.com" rel="dns-prefetch">
<link rel="icon" href="/favicon.png">
<link rel="apple-touch-icon" href="/img/icons/apple-180x180.png" sizes="180x180">
<meta name="msapplication-config" content="/browserconfig.xml">
<link rel="sitemap" type="application/xml" href="/sitemap.xml">
<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=GTM-PVR7M2G"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","GTM-PVR7M2G",{anonymize_ip:!0})</script>
<link rel="search" type="application/opensearchdescription+xml" title="Turple: Cloud Native Platform" href="/opensearch.xml">
<link rel="manifest" href="/manifest.webmanifest">
<meta name="theme-color" content="#d14671">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#21222c">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Turple: Cloud Native Platform Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Turple: Cloud Native Platform Blog Atom Feed"><title data-react-helmet="true">Building a Data Pipeline using QuestDB and Confluent Kafka | Turple: Cloud Native Platform</title><meta data-react-helmet="true" property="og:title" content="Building a Data Pipeline using QuestDB and Confluent Kafka | Turple: Cloud Native Platform"><meta data-react-helmet="true" name="description" content="How to collate data with Kafka and implement a data pipeline that collects real-time ETH market data and stores data to QuestDB through Kafka connections."><meta data-react-helmet="true" name="twitter:description" content="How to collate data with Kafka and implement a data pipeline that collects real-time ETH market data and stores data to QuestDB through Kafka connections."><meta data-react-helmet="true" property="og:description" content="How to collate data with Kafka and implement a data pipeline that collects real-time ETH market data and stores data to QuestDB through Kafka connections."><meta data-react-helmet="true" name="twitter:title" content="Building a Data Pipeline using QuestDB and Confluent Kafka | Turple: Cloud Native Platform"><meta data-react-helmet="true" name="twitter:image:alt" content="Image for &quot;Building a Data Pipeline using QuestDB and Confluent Kafka | Turple: Cloud Native Platform&quot;"><meta data-react-helmet="true" name="keywords" content="tutorial,python,ethereum,market data,crypto,kafka confluent"><meta data-react-helmet="true" property="og:image" content="https://turpleio.github.io/img/blog/2022-06-07/banner.png"><meta data-react-helmet="true" name="twitter:image" content="https://turpleio.github.io/img/blog/2022-06-07/banner.png"><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><link rel="stylesheet" href="/assets/css/styles.4f6557e4.css">
</head>
<body itemscope itemtype="http://schema.org/Organization">
<meta itemprop="name" content="Turple: Cloud Native Platform">
<meta itemprop="description" content="Turple is a cloud native platform which can help you build and operate your services on cloud.">
<meta itemprop="url" content="https://turpleio.github.io">
<meta itemprop="logo" content="https://turpleio.github.io/img/favicon.png">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}()</script><div id="__docusaurus">
<nav class="navbar navbar_wBc8 navbar--light"><div class="navbar__inner inner_Y8Z6"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand brand_AtiA" href="/">QuestDB</a></div><div class="navbar__items navbar__items--right"></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand brand_AtiA" href="/">QuestDB</a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"></ul></div></div></div></nav><div class="wrapper_DIJ0 blog-wrapper"><div class="container margin-vert--lg"><div class="row"><div class="col col--3"><div class="sidebar_q+wC thin-scrollbar"><h3 class="sidebarItemTitle_9G5K">Recent posts</h3><ul class="sidebarItemList_6T4b"><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/blog/2022/12/19/merry-questmas-gifts-2023">Merry Questmas! Here are your gifts for 2023...</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/blog/2022/12/13/using-prometheus-loki-grafana-monitor-questdb-kubernetes">Using Prometheus, Loki, and Grafana to monitor QuestDB in Kubernetes</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/blog/2022/11/30/full-table-scan-are-fast">Listen to Your CPU - Full-table Scans Are Fast</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/blog/2022/11/25/questdb-6.6.1-dynamic-commits">QuestDB 6.6.1 - Dynamic Commits</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/blog/2022/11/23/sql-extensions-time-series-data-questdb-part-ii">SQL Extensions for Time Series Data in QuestDB - Part II</a></li></ul></div></div><main class="col col--7"><article><header><h1 class="title_KBQu">Building a Data Pipeline using QuestDB and Confluent Kafka</h1><time datetime="2022-06-07T00:00:00.000Z" class="date_A31P">June 7, 2022 · 10 min read</time><div class="avatar margin-vert--md"><a href="https://github.com/soot3" target="_blank" rel="noopener noreferrer" class="avatar__photo-link avatar__photo"><img src="https://avatars.githubusercontent.com/soot3" alt="Sooter Saalu"></a><div class="avatar__intro"><h4 class="avatar__name"><a href="https://github.com/soot3" target="_blank" rel="noopener noreferrer">Sooter Saalu</a></h4><small class="avatar__subtitle">Guest post</small></div></div></header><div class="markdown"><p><em>This tutorial is a guest post contributed by
<a href="https://github.com/soot3" target="_blank" rel="noopener noreferrer">Sooter Saalu</a>, who put together a tutorial to show
you how to build a data pipeline using Confluent Kafka, QuestDB, and Python. If
you like this content or have any feedback, feel free to reach out to the author
or to us on <a href="https://github.com/questdb/questdb" target="_blank" rel="noopener noreferrer">GitHub</a> or on
<a href="https://" target="_blank" rel="noopener noreferrer">Slack</a>.</em></p><figure><img alt="QuestDB 6.4 Release Highlights" class="image_1-Fc" height="800" src="/img/blog/2022-06-07/banner.png" width="900"></figure><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="introduction"></a>Introduction<a class="hash-link" href="#introduction" title="Direct link to heading">#</a></h2><p>A data pipeline, at its base, is a series of data processing measures that is
used to automate the transport and transformation of data between systems or
data stores. Data pipelines can be used for a wide range of use cases in a
business, including aggregating data on customers for recommendation purposes or
customer relationship management, combining and transforming data from multiple
sources, as well as collating/streaming real-time data from sensors or
transactions.</p><p>For example, a company like Airbnb could have data pipelines that go back and
forth between their application and their platform of choice to improve customer
service. Netflix utilizes a recommendation data pipeline that automates the data
science steps for generating movie and series recommendations. Also, depending
on the rate at which it updates, a batch or streaming data pipeline can be used
to generate and update the data used in an analytics dashboard for stakeholders.</p><p>In this article, you will learn how to implement a data pipeline that utilizes
Kafka to aggregate data from multiple sources into a QuestDB database.
Specifically, you will see the implementation of a streaming data pipeline that
collates cryptocurrency market price data from CoinCap into a QuestDB instance
where metrics, analytics, and further dashboards can be made.</p><p><img src="https://i.imgur.com/F0ysUIp.png" alt="Rough architecture diagram"></p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="data-pipelines-using-kafka-and-questdb"></a>Data Pipelines Using Kafka and QuestDB<a class="hash-link" href="#data-pipelines-using-kafka-and-questdb" title="Direct link to heading">#</a></h2><p>Data pipelines are made up of a data source (e.g., applications, databases, or
web services), a processing or transformation procedure (actions such as moving
or modifying the data, occurring in parallel or in sequence with each other),
and a destination (e.g., another application, repository, or web service).</p><p>The type or format of data being moved or transformed, the size of the data, and
the rate at which it will be moved or transformed (batch or stream processing)
are some other considerations you need to be aware of when building data
pipelines. A data pipeline that only needs to be triggered once a month will be
different from one made to handle real-time notifications from your application.</p><p><a href="https://kafka.apache.org/" target="_blank" rel="noopener noreferrer"><em>Apache Kafka</em></a> is an open source distributed event
platform optimized for processing and modifying streaming data in real time. It
is a fast and scalable option for creating high-performing, low-latency data
pipelines and building functionality for the data integration of high-volume
streaming data from multiple sources. Kafka is a fairly popular tool used by
thousands of
<a href="https://kafka.apache.org/powered-by#:~:text=Today%2C%20Kafka%20is%20used%20by,strategies%20with%20event%20streaming%20architecture." target="_blank" rel="noopener noreferrer">companies</a>.</p><p><a href="https://questdb.io/" target="_blank" rel="noopener noreferrer"><em>QuestDB</em></a> is a high-performance, open source SQL database
designed to process time series data with ease and speed. It is a relational
column-oriented database with applications in areas such as IoT, sensor data and
observability, financial services, and machine learning. The database’s
functionality is written in Java with a supported REST API and support for the
<a href="https://www.postgresql.org/" target="_blank" rel="noopener noreferrer">PostgreSQL</a> wire protocol and
<a href="https://www.influxdata.com/" target="_blank" rel="noopener noreferrer">InfluxDB</a> line protocol, allowing for multiple
ways to ingest and query data in QuestDB.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="preparation"></a>Preparation<a class="hash-link" href="#preparation" title="Direct link to heading">#</a></h2><p>QuestDB can be installed using
<a href="https://questdb.io/docs/get-started/docker" target="_blank" rel="noopener noreferrer">Docker</a>,
<a href="https://questdb.io/docs/get-started/binaries" target="_blank" rel="noopener noreferrer">TAR files</a>, or a package manager
such as <a href="https://questdb.io/docs/get-started/homebrew" target="_blank" rel="noopener noreferrer">Homebrew</a>. And
<a href="https://www.confluent.io/" target="_blank" rel="noopener noreferrer">Confluent</a> offers a Kafka distribution, Confluent
Platform, with addons that ease your data pipeline process and can be
<a href="https://docs.confluent.io/platform/current/quickstart/ce-docker-quickstart.html" target="_blank" rel="noopener noreferrer">installed</a>
using Docker images or its downloaded TAR file.</p><blockquote><p>Note: Confluent Platform is licensed separately from Apache Kafka. If you wish
to use this setup in production environment, make sure to read through the
<a href="https://docs.confluent.io/platform/current/installation/license.html" target="_blank" rel="noopener noreferrer">Confluent Platform Licenses</a>.</p></blockquote><p>As for market data, you can utilize the <a href="https://docs.coincap.io/" target="_blank" rel="noopener noreferrer">CoinCap API</a>
to collate ETH market data. But there are also other
<a href="https://github.com/ColinEberhardt/awesome-public-streaming-datasets" target="_blank" rel="noopener noreferrer">streaming financial data resources</a>.</p><p>All files used in the article are available in this
<a href="https://github.com/Soot3/coincap_kafka_questdb" target="_blank" rel="noopener noreferrer">Github repository</a>. You can
clone the repository to work through the steps directly:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI shell"><div tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#f8f8f2;background-color:#262833"><div class="token-line" style="color:#f8f8f2"><span class="token function" style="color:#8be9fd">git</span><span class="token plain"> clone https://github.com/Soot3/coincap_kafka_questdb.git</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="install-questdb-and-kafka"></a>Install QuestDB and Kafka<a class="hash-link" href="#install-questdb-and-kafka" title="Direct link to heading">#</a></h2><p>For the purpose of this article, you can install both using a
<a href="https://github.com/Soot3/coincap_kafka_questdb/blob/main/docker/docker-compose.yml" target="_blank" rel="noopener noreferrer">Docker Compose file</a>
that creates the required Docker containers for the Kafka and QuestDB pipeline:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI yaml"><div tabindex="0" class="prism-code language-yaml codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#f8f8f2;background-color:#262833"><div class="token-line" style="color:#f8f8f2"><span class="token punctuation" style="color:#f8f8f2">---</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token key atrule">version</span><span class="token punctuation" style="color:#f8f8f2">:</span><span class="token plain"> </span><span class="token string" style="color:#f1fa8c">&quot;3&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token key atrule">services</span><span class="token punctuation" style="color:#f8f8f2">:</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token key atrule">zookeeper</span><span class="token punctuation" style="color:#f8f8f2">:</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token key atrule">image</span><span class="token punctuation" style="color:#f8f8f2">:</span><span class="token plain"> confluentinc/cp</span><span class="token punctuation" style="color:#f8f8f2">-</span><span class="token plain">zookeeper</span><span class="token punctuation" style="color:#f8f8f2">:</span><span class="token plain">7.0.1</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token key atrule">hostname</span><span class="token punctuation" style="color:#f8f8f2">:</span><span class="token plain"> zookeeper</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token key atrule">container_name</span><span class="token punctuation" style="color:#f8f8f2">:</span><span class="token plain"> zookeeper</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token key atrule">ports</span><span class="token punctuation" style="color:#f8f8f2">:</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token punctuation" style="color:#f8f8f2">-</span><span class="token plain"> </span><span class="token string" style="color:#f1fa8c">&quot;2181:2181&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token key atrule">environment</span><span class="token punctuation" style="color:#f8f8f2">:</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token key atrule">ZOOKEEPER_CLIENT_PORT</span><span class="token punctuation" style="color:#f8f8f2">:</span><span class="token plain"> </span><span class="token number" style="color:#50fa7b">2181</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token key atrule">ZOOKEEPER_TICK_TIME</span><span class="token punctuation" style="color:#f8f8f2">:</span><span class="token plain"> </span><span class="token number" style="color:#50fa7b">2000</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token key atrule">broker</span><span class="token punctuation" style="color:#f8f8f2">:</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token key atrule">image</span><span class="token punctuation" style="color:#f8f8f2">:</span><span class="token plain"> confluentinc/cp</span><span class="token punctuation" style="color:#f8f8f2">-</span><span class="token plain">server</span><span class="token punctuation" style="color:#f8f8f2">:</span><span class="token plain">7.0.1</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token key atrule">hostname</span><span class="token punctuation" style="color:#f8f8f2">:</span><span class="token plain"> broker</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token key atrule">container_name</span><span class="token punctuation" style="color:#f8f8f2">:</span><span class="token plain"> broker</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token key atrule">depends_on</span><span class="token punctuation" style="color:#f8f8f2">:</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token punctuation" style="color:#f8f8f2">-</span><span class="token plain"> zookeeper</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token key atrule">ports</span><span class="token punctuation" style="color:#f8f8f2">:</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token punctuation" style="color:#f8f8f2">-</span><span class="token plain"> </span><span class="token string" style="color:#f1fa8c">&quot;9092:9092&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token punctuation" style="color:#f8f8f2">-</span><span class="token plain"> </span><span class="token string" style="color:#f1fa8c">&quot;9101:9101&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token key atrule">environment</span><span class="token punctuation" style="color:#f8f8f2">:</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token key atrule">KAFKA_BROKER_ID</span><span class="token punctuation" style="color:#f8f8f2">:</span><span class="token plain"> </span><span class="token number" style="color:#50fa7b">1</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token key atrule">KAFKA_ZOOKEEPER_CONNECT</span><span class="token punctuation" style="color:#f8f8f2">:</span><span class="token plain"> </span><span class="token string" style="color:#f1fa8c">&quot;zookeeper:2181&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token key atrule">KAFKA_LISTENER_SECURITY_PROTOCOL_MAP</span><span class="token punctuation" style="color:#f8f8f2">:</span><span class="token plain"> PLAINTEXT</span><span class="token punctuation" style="color:#f8f8f2">:</span><span class="token plain">PLAINTEXT</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain">PLAINTEXT_HOST</span><span class="token punctuation" style="color:#f8f8f2">:</span><span class="token plain">PLAINTEXT</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token key atrule">KAFKA_ADVERTISED_LISTENERS</span><span class="token punctuation" style="color:#f8f8f2">:</span><span class="token plain"> PLAINTEXT</span><span class="token punctuation" style="color:#f8f8f2">:</span><span class="token plain">//broker</span><span class="token punctuation" style="color:#f8f8f2">:</span><span class="token number" style="color:#50fa7b">29092</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain">PLAINTEXT_HOST</span><span class="token punctuation" style="color:#f8f8f2">:</span><span class="token plain">//localhost</span><span class="token punctuation" style="color:#f8f8f2">:</span><span class="token number" style="color:#50fa7b">9092</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token key atrule">KAFKA_METRIC_REPORTERS</span><span class="token punctuation" style="color:#f8f8f2">:</span><span class="token plain"> io.confluent.metrics.reporter.ConfluentMetricsReporter</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token key atrule">KAFKA_OFFSETS_TOPIC_REPLICATION_FACTOR</span><span class="token punctuation" style="color:#f8f8f2">:</span><span class="token plain"> </span><span class="token number" style="color:#50fa7b">1</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token key atrule">KAFKA_GROUP_INITIAL_REBALANCE_DELAY_MS</span><span class="token punctuation" style="color:#f8f8f2">:</span><span class="token plain"> </span><span class="token number" style="color:#50fa7b">0</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token key atrule">KAFKA_CONFLUENT_LICENSE_TOPIC_REPLICATION_FACTOR</span><span class="token punctuation" style="color:#f8f8f2">:</span><span class="token plain"> </span><span class="token number" style="color:#50fa7b">1</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token key atrule">KAFKA_CONFLUENT_BALANCER_TOPIC_REPLICATION_FACTOR</span><span class="token punctuation" style="color:#f8f8f2">:</span><span class="token plain"> </span><span class="token number" style="color:#50fa7b">1</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token key atrule">KAFKA_TRANSACTION_STATE_LOG_MIN_ISR</span><span class="token punctuation" style="color:#f8f8f2">:</span><span class="token plain"> </span><span class="token number" style="color:#50fa7b">1</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token key atrule">KAFKA_TRANSACTION_STATE_LOG_REPLICATION_FACTOR</span><span class="token punctuation" style="color:#f8f8f2">:</span><span class="token plain"> </span><span class="token number" style="color:#50fa7b">1</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token key atrule">KAFKA_JMX_PORT</span><span class="token punctuation" style="color:#f8f8f2">:</span><span class="token plain"> </span><span class="token number" style="color:#50fa7b">9101</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token key atrule">KAFKA_JMX_HOSTNAME</span><span class="token punctuation" style="color:#f8f8f2">:</span><span class="token plain"> localhost</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token key atrule">KAFKA_CONFLUENT_SCHEMA_REGISTRY_URL</span><span class="token punctuation" style="color:#f8f8f2">:</span><span class="token plain"> http</span><span class="token punctuation" style="color:#f8f8f2">:</span><span class="token plain">//schema</span><span class="token punctuation" style="color:#f8f8f2">-</span><span class="token plain">registry</span><span class="token punctuation" style="color:#f8f8f2">:</span><span class="token number" style="color:#50fa7b">8081</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token key atrule">CONFLUENT_METRICS_REPORTER_BOOTSTRAP_SERVERS</span><span class="token punctuation" style="color:#f8f8f2">:</span><span class="token plain"> broker</span><span class="token punctuation" style="color:#f8f8f2">:</span><span class="token number" style="color:#50fa7b">29092</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token key atrule">CONFLUENT_METRICS_REPORTER_TOPIC_REPLICAS</span><span class="token punctuation" style="color:#f8f8f2">:</span><span class="token plain"> </span><span class="token number" style="color:#50fa7b">1</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token key atrule">CONFLUENT_METRICS_ENABLE</span><span class="token punctuation" style="color:#f8f8f2">:</span><span class="token plain"> </span><span class="token string" style="color:#f1fa8c">&quot;true&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token key atrule">CONFLUENT_SUPPORT_CUSTOMER_ID</span><span class="token punctuation" style="color:#f8f8f2">:</span><span class="token plain"> </span><span class="token string" style="color:#f1fa8c">&quot;anonymous&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token key atrule">kafka-connect</span><span class="token punctuation" style="color:#f8f8f2">:</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token key atrule">image</span><span class="token punctuation" style="color:#f8f8f2">:</span><span class="token plain"> yitaekhwang/cp</span><span class="token punctuation" style="color:#f8f8f2">-</span><span class="token plain">kafka</span><span class="token punctuation" style="color:#f8f8f2">-</span><span class="token plain">connect</span><span class="token punctuation" style="color:#f8f8f2">-</span><span class="token plain">postgres</span><span class="token punctuation" style="color:#f8f8f2">:</span><span class="token plain">6.1.0</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token key atrule">hostname</span><span class="token punctuation" style="color:#f8f8f2">:</span><span class="token plain"> connect</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token key atrule">container_name</span><span class="token punctuation" style="color:#f8f8f2">:</span><span class="token plain"> connect</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token key atrule">depends_on</span><span class="token punctuation" style="color:#f8f8f2">:</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token punctuation" style="color:#f8f8f2">-</span><span class="token plain"> broker</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token punctuation" style="color:#f8f8f2">-</span><span class="token plain"> zookeeper</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token key atrule">ports</span><span class="token punctuation" style="color:#f8f8f2">:</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token punctuation" style="color:#f8f8f2">-</span><span class="token plain"> </span><span class="token string" style="color:#f1fa8c">&quot;8083:8083&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token key atrule">environment</span><span class="token punctuation" style="color:#f8f8f2">:</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token key atrule">CONNECT_BOOTSTRAP_SERVERS</span><span class="token punctuation" style="color:#f8f8f2">:</span><span class="token plain"> </span><span class="token string" style="color:#f1fa8c">&quot;broker:29092&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token key atrule">CONNECT_REST_ADVERTISED_HOST_NAME</span><span class="token punctuation" style="color:#f8f8f2">:</span><span class="token plain"> connect</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token key atrule">CONNECT_REST_PORT</span><span class="token punctuation" style="color:#f8f8f2">:</span><span class="token plain"> </span><span class="token number" style="color:#50fa7b">8083</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token key atrule">CONNECT_GROUP_ID</span><span class="token punctuation" style="color:#f8f8f2">:</span><span class="token plain"> compose</span><span class="token punctuation" style="color:#f8f8f2">-</span><span class="token plain">connect</span><span class="token punctuation" style="color:#f8f8f2">-</span><span class="token plain">group</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token key atrule">CONNECT_CONFIG_STORAGE_TOPIC</span><span class="token punctuation" style="color:#f8f8f2">:</span><span class="token plain"> docker</span><span class="token punctuation" style="color:#f8f8f2">-</span><span class="token plain">connect</span><span class="token punctuation" style="color:#f8f8f2">-</span><span class="token plain">configs</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token key atrule">CONNECT_CONFIG_STORAGE_REPLICATION_FACTOR</span><span class="token punctuation" style="color:#f8f8f2">:</span><span class="token plain"> </span><span class="token number" style="color:#50fa7b">1</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token key atrule">CONNECT_OFFSET_FLUSH_INTERVAL_MS</span><span class="token punctuation" style="color:#f8f8f2">:</span><span class="token plain"> </span><span class="token number" style="color:#50fa7b">10000</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token key atrule">CONNECT_OFFSET_STORAGE_TOPIC</span><span class="token punctuation" style="color:#f8f8f2">:</span><span class="token plain"> docker</span><span class="token punctuation" style="color:#f8f8f2">-</span><span class="token plain">connect</span><span class="token punctuation" style="color:#f8f8f2">-</span><span class="token plain">offsets</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token key atrule">CONNECT_OFFSET_STORAGE_REPLICATION_FACTOR</span><span class="token punctuation" style="color:#f8f8f2">:</span><span class="token plain"> </span><span class="token number" style="color:#50fa7b">1</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token key atrule">CONNECT_STATUS_STORAGE_TOPIC</span><span class="token punctuation" style="color:#f8f8f2">:</span><span class="token plain"> docker</span><span class="token punctuation" style="color:#f8f8f2">-</span><span class="token plain">connect</span><span class="token punctuation" style="color:#f8f8f2">-</span><span class="token plain">status</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token key atrule">CONNECT_STATUS_STORAGE_REPLICATION_FACTOR</span><span class="token punctuation" style="color:#f8f8f2">:</span><span class="token plain"> </span><span class="token number" style="color:#50fa7b">1</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token key atrule">CONNECT_KEY_CONVERTER</span><span class="token punctuation" style="color:#f8f8f2">:</span><span class="token plain"> org.apache.kafka.connect.json.JsonConverter</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token key atrule">CONNECT_VALUE_CONVERTER</span><span class="token punctuation" style="color:#f8f8f2">:</span><span class="token plain"> org.apache.kafka.connect.json.JsonConverter</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token key atrule">questdb</span><span class="token punctuation" style="color:#f8f8f2">:</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token key atrule">image</span><span class="token punctuation" style="color:#f8f8f2">:</span><span class="token plain"> questdb/questdb</span><span class="token punctuation" style="color:#f8f8f2">:</span><span class="token plain">latest</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token key atrule">pull_policy</span><span class="token punctuation" style="color:#f8f8f2">:</span><span class="token plain"> always</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token key atrule">hostname</span><span class="token punctuation" style="color:#f8f8f2">:</span><span class="token plain"> questdb</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token key atrule">container_name</span><span class="token punctuation" style="color:#f8f8f2">:</span><span class="token plain"> questdb</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token key atrule">ports</span><span class="token punctuation" style="color:#f8f8f2">:</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token punctuation" style="color:#f8f8f2">-</span><span class="token plain"> </span><span class="token string" style="color:#f1fa8c">&quot;9000:9000&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">      </span><span class="token punctuation" style="color:#f8f8f2">-</span><span class="token plain"> </span><span class="token string" style="color:#f1fa8c">&quot;8812:8812&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>In sequential order, this Docker Compose file installs Confluent-managed Kafka
tools,
<a href="https://www.cloudkarafka.com/blog/cloudkarafka-what-is-zookeeper.html" target="_blank" rel="noopener noreferrer">Zookeeper</a>,
and
<a href="https://developer.confluent.io/learn-kafka/apache-kafka/brokers/" target="_blank" rel="noopener noreferrer">Kafka broker</a>,
which manage the connections and processes in the Kafka ecosystem. Then, it
installs a
<a href="https://docs.confluent.io/kafka-connect-jdbc/current/index.html" target="_blank" rel="noopener noreferrer">JDBC Connector</a>
that will enable the connection between Kafka and any relational database such
as QuestDB, this particular
<a href="https://hub.docker.com/r/yitaekhwang/cp-kafka-connect-postgres" target="_blank" rel="noopener noreferrer">JDBC connector image</a>
is a custom connector created to simplify the connection between Confluent’s
Kafka service and your Postgres database Finally, it installs the latest version
of QuestDB.</p><p>You can set up Kafka and QuestDB by moving to the Docker directory and then
running the Docker Compose file:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI shell"><div tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#f8f8f2;background-color:#262833"><div class="token-line" style="color:#f8f8f2"><span class="token builtin class-name" style="color:#bd93f9">cd</span><span class="token plain">  coincap_kafka_questdb/docker</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">docker-compose up -d</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>The installation process should take a few minutes. You can check if the
services are up and working with <code>docker-compose ps</code>. Once you see the <code>connect</code>
container status as <code>healthy</code> your cluster will be ready to go.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="connect-kafka-and-questdb"></a>Connect Kafka and QuestDB<a class="hash-link" href="#connect-kafka-and-questdb" title="Direct link to heading">#</a></h2><p>At this point, your Kafka cluster and QuestDB instance are still unconnected,
with no avenue to pass data between them. Using your installed connector, you
can create this connection by setting the configuration settings for the
connector:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI json"><div tabindex="0" class="prism-code language-json codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#f8f8f2;background-color:#262833"><div class="token-line" style="color:#f8f8f2"><span class="token punctuation" style="color:#f8f8f2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token property">&quot;name&quot;</span><span class="token operator" style="color:#ff79c6">:</span><span class="token plain"> </span><span class="token string" style="color:#f1fa8c">&quot;postgres-sink-eth&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token property">&quot;config&quot;</span><span class="token operator" style="color:#ff79c6">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#f8f8f2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token property">&quot;connector.class&quot;</span><span class="token operator" style="color:#ff79c6">:</span><span class="token plain"> </span><span class="token string" style="color:#f1fa8c">&quot;io.confluent.connect.jdbc.JdbcSinkConnector&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token property">&quot;tasks.max&quot;</span><span class="token operator" style="color:#ff79c6">:</span><span class="token plain"> </span><span class="token string" style="color:#f1fa8c">&quot;1&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token property">&quot;topics&quot;</span><span class="token operator" style="color:#ff79c6">:</span><span class="token plain"> </span><span class="token string" style="color:#f1fa8c">&quot;topic_ETH&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token property">&quot;key.converter&quot;</span><span class="token operator" style="color:#ff79c6">:</span><span class="token plain"> </span><span class="token string" style="color:#f1fa8c">&quot;org.apache.kafka.connect.storage.StringConverter&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token property">&quot;value.converter&quot;</span><span class="token operator" style="color:#ff79c6">:</span><span class="token plain"> </span><span class="token string" style="color:#f1fa8c">&quot;org.apache.kafka.connect.json.JsonConverter&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token property">&quot;connection.url&quot;</span><span class="token operator" style="color:#ff79c6">:</span><span class="token plain"> </span><span class="token string" style="color:#f1fa8c">&quot;jdbc:postgresql://questdb:8812/qdb?useSSL=false&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token property">&quot;connection.user&quot;</span><span class="token operator" style="color:#ff79c6">:</span><span class="token plain"> </span><span class="token string" style="color:#f1fa8c">&quot;admin&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token property">&quot;connection.password&quot;</span><span class="token operator" style="color:#ff79c6">:</span><span class="token plain"> </span><span class="token string" style="color:#f1fa8c">&quot;quest&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token property">&quot;key.converter.schemas.enable&quot;</span><span class="token operator" style="color:#ff79c6">:</span><span class="token plain"> </span><span class="token string" style="color:#f1fa8c">&quot;false&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token property">&quot;value.converter.schemas.enable&quot;</span><span class="token operator" style="color:#ff79c6">:</span><span class="token plain"> </span><span class="token string" style="color:#f1fa8c">&quot;true&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token property">&quot;auto.create&quot;</span><span class="token operator" style="color:#ff79c6">:</span><span class="token plain"> </span><span class="token string" style="color:#f1fa8c">&quot;false&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token property">&quot;insert.mode&quot;</span><span class="token operator" style="color:#ff79c6">:</span><span class="token plain"> </span><span class="token string" style="color:#f1fa8c">&quot;insert&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token property">&quot;pk.mode&quot;</span><span class="token operator" style="color:#ff79c6">:</span><span class="token plain"> </span><span class="token string" style="color:#f1fa8c">&quot;none&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">  </span><span class="token punctuation" style="color:#f8f8f2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token punctuation" style="color:#f8f8f2">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>Here, you are setting the topic or topics that the connection monitors, the
format for the message entries, and the authentication details for the
connection. QuestDB then accepts <em>admin</em> and <em>quest</em> as user and password by
default.</p><p>You can send this configuration to your installed connector using the following
command:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI shell"><div tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#f8f8f2;background-color:#262833"><div class="token-line" style="color:#f8f8f2"><span class="token function" style="color:#8be9fd">curl</span><span class="token plain"> -X POST -H </span><span class="token string" style="color:#f1fa8c">&quot;Accept:application/json&quot;</span><span class="token plain"> -H </span><span class="token string" style="color:#f1fa8c">&quot;Content-Type:application/json&quot;</span><span class="token plain"> --data @postgres-sink-eth.json http://localhost:8083/connectors</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>When successfully executed, you should be able to see a response in JSON that
includes the configuration above.</p><p>At this point, you have a connected QuestDB instance that will monitor the
<code>topic_ETH</code> topic and pull any records sent to it for storage on the database.
You can then create a table for the records on your database.</p><p>QuestDB has an interactive web console for that and can be accessed at
<code>http://localhost:9000/</code>. Here, you can query the data and generate some simple
visualizations directly. Use the following command to create a table for your
Coincap records</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI sql"><div tabindex="0" class="prism-code language-sql codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#f8f8f2;background-color:#262833"><div class="token-line" style="color:#f8f8f2"><span class="token keyword" style="color:#ff79c6">CREATE</span><span class="token plain"> </span><span class="token keyword" style="color:#ff79c6">TABLE</span><span class="token plain"> topic_ETH </span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token punctuation" style="color:#f8f8f2">`</span><span class="token keyword" style="color:#ff79c6">timestamp</span><span class="token punctuation" style="color:#f8f8f2">`</span><span class="token plain"> </span><span class="token keyword" style="color:#ff79c6">timestamp</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> currency symbol</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> amount </span><span class="token keyword" style="color:#ff79c6">float</span><span class="token punctuation" style="color:#f8f8f2">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>This creates a formatted table for your records, the next step involves
generating records that will be sent to this table.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="generate-market-data-using-coincap-api-and-python"></a>Generate market data using CoinCap API and Python<a class="hash-link" href="#generate-market-data-using-coincap-api-and-python" title="Direct link to heading">#</a></h2><p>Using CoinCap’s API and some Python code, you can create a Kafka Producer that
will generate data in real time:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI python"><div tabindex="0" class="prism-code language-python codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#f8f8f2;background-color:#262833"><div class="token-line" style="color:#f8f8f2"><span class="token comment" style="color:#6272a4"># importing packages</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#ff79c6">import</span><span class="token plain"> time</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> json</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#ff79c6">import</span><span class="token plain"> datetime </span><span class="token keyword" style="color:#ff79c6">as</span><span class="token plain"> dt</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#ff79c6">import</span><span class="token plain"> requests</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#ff79c6">from</span><span class="token plain"> kafka </span><span class="token keyword" style="color:#ff79c6">import</span><span class="token plain"> KafkaProducer</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token comment" style="color:#6272a4"># initializing Kafka Producer Client</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">producer </span><span class="token operator" style="color:#ff79c6">=</span><span class="token plain"> KafkaProducer</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">bootstrap_servers</span><span class="token operator" style="color:#ff79c6">=</span><span class="token punctuation" style="color:#f8f8f2">[</span><span class="token string" style="color:#f1fa8c">&#x27;localhost:9092&#x27;</span><span class="token punctuation" style="color:#f8f8f2">]</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">                         value_serializer</span><span class="token operator" style="color:#ff79c6">=</span><span class="token keyword" style="color:#ff79c6">lambda</span><span class="token plain"> x</span><span class="token punctuation" style="color:#f8f8f2">:</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">                         json</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">dumps</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">x</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain">default</span><span class="token operator" style="color:#ff79c6">=</span><span class="token builtin" style="color:#bd93f9">str</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">encode</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#f1fa8c">&#x27;utf-8&#x27;</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#ff79c6">print</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#f1fa8c">&#x27;Initialized Kafka producer at {}&#x27;</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token builtin" style="color:#bd93f9">format</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">dt</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">datetime</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">utcnow</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token comment" style="color:#6272a4"># Creating a continuous loop to process the real-time data</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#ff79c6">while</span><span class="token plain"> </span><span class="token boolean" style="color:#bd93f9">True</span><span class="token punctuation" style="color:#f8f8f2">:</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token comment" style="color:#6272a4"># API request</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    uri </span><span class="token operator" style="color:#ff79c6">=</span><span class="token plain"> </span><span class="token string" style="color:#f1fa8c">&#x27;http://api.coincap.io/v2/assets/ethereum&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    res </span><span class="token operator" style="color:#ff79c6">=</span><span class="token plain"> requests</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">request</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#f1fa8c">&quot;GET&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain">uri</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    start_time </span><span class="token operator" style="color:#ff79c6">=</span><span class="token plain"> time</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">time</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token comment" style="color:#6272a4"># Processing API response if successful</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token keyword" style="color:#ff79c6">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">res</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">status_code</span><span class="token operator" style="color:#ff79c6">==</span><span class="token number" style="color:#50fa7b">200</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">:</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token comment" style="color:#6272a4"># read json response</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">        raw_data </span><span class="token operator" style="color:#ff79c6">=</span><span class="token plain"> json</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">loads</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">res</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">content</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">        </span><span class="token comment" style="color:#6272a4"># add the schema for Kafka</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">        data </span><span class="token operator" style="color:#ff79c6">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#f8f8f2">{</span><span class="token string" style="color:#f1fa8c">&#x27;schema&#x27;</span><span class="token punctuation" style="color:#f8f8f2">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#f8f8f2">{</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">            </span><span class="token string" style="color:#f1fa8c">&#x27;type&#x27;</span><span class="token punctuation" style="color:#f8f8f2">:</span><span class="token plain"> </span><span class="token string" style="color:#f1fa8c">&#x27;struct&#x27;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">            </span><span class="token string" style="color:#f1fa8c">&#x27;fields&#x27;</span><span class="token punctuation" style="color:#f8f8f2">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#f8f8f2">[</span><span class="token punctuation" style="color:#f8f8f2">{</span><span class="token string" style="color:#f1fa8c">&#x27;type&#x27;</span><span class="token punctuation" style="color:#f8f8f2">:</span><span class="token plain"> </span><span class="token string" style="color:#f1fa8c">&#x27;string&#x27;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#f1fa8c">&#x27;optional&#x27;</span><span class="token punctuation" style="color:#f8f8f2">:</span><span class="token plain"> </span><span class="token boolean" style="color:#bd93f9">False</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#f1fa8c">&#x27;field&#x27;</span><span class="token punctuation" style="color:#f8f8f2">:</span><span class="token plain"> </span><span class="token string" style="color:#f1fa8c">&#x27;currency&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">                    </span><span class="token punctuation" style="color:#f8f8f2">}</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#f8f8f2">{</span><span class="token string" style="color:#f1fa8c">&#x27;type&#x27;</span><span class="token punctuation" style="color:#f8f8f2">:</span><span class="token plain"> </span><span class="token string" style="color:#f1fa8c">&#x27;float&#x27;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#f1fa8c">&#x27;optional&#x27;</span><span class="token punctuation" style="color:#f8f8f2">:</span><span class="token plain"> </span><span class="token boolean" style="color:#bd93f9">False</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#f1fa8c">&#x27;field&#x27;</span><span class="token punctuation" style="color:#f8f8f2">:</span><span class="token plain"> </span><span class="token string" style="color:#f1fa8c">&#x27;amount&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">                    </span><span class="token punctuation" style="color:#f8f8f2">}</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#f8f8f2">{</span><span class="token string" style="color:#f1fa8c">&#x27;type&#x27;</span><span class="token punctuation" style="color:#f8f8f2">:</span><span class="token plain"> </span><span class="token string" style="color:#f1fa8c">&#x27;string&#x27;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#f1fa8c">&#x27;optional&#x27;</span><span class="token punctuation" style="color:#f8f8f2">:</span><span class="token plain"> </span><span class="token boolean" style="color:#bd93f9">False</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">                    </span><span class="token string" style="color:#f1fa8c">&#x27;field&#x27;</span><span class="token punctuation" style="color:#f8f8f2">:</span><span class="token plain"> </span><span class="token string" style="color:#f1fa8c">&#x27;timestamp&#x27;</span><span class="token punctuation" style="color:#f8f8f2">}</span><span class="token punctuation" style="color:#f8f8f2">]</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">            </span><span class="token string" style="color:#f1fa8c">&#x27;optional&#x27;</span><span class="token punctuation" style="color:#f8f8f2">:</span><span class="token plain"> </span><span class="token boolean" style="color:#bd93f9">False</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">            </span><span class="token string" style="color:#f1fa8c">&#x27;name&#x27;</span><span class="token punctuation" style="color:#f8f8f2">:</span><span class="token plain"> </span><span class="token string" style="color:#f1fa8c">&#x27;Coincap&#x27;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">            </span><span class="token punctuation" style="color:#f8f8f2">}</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> </span><span class="token string" style="color:#f1fa8c">&#x27;payload&#x27;</span><span class="token punctuation" style="color:#f8f8f2">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#f8f8f2">{</span><span class="token string" style="color:#f1fa8c">&#x27;timestamp&#x27;</span><span class="token punctuation" style="color:#f8f8f2">:</span><span class="token plain"> dt</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">datetime</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">utcnow</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">                        </span><span class="token string" style="color:#f1fa8c">&#x27;currency&#x27;</span><span class="token punctuation" style="color:#f8f8f2">:</span><span class="token plain"> raw_data</span><span class="token punctuation" style="color:#f8f8f2">[</span><span class="token string" style="color:#f1fa8c">&#x27;data&#x27;</span><span class="token punctuation" style="color:#f8f8f2">]</span><span class="token punctuation" style="color:#f8f8f2">[</span><span class="token string" style="color:#f1fa8c">&#x27;id&#x27;</span><span class="token punctuation" style="color:#f8f8f2">]</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">                        </span><span class="token string" style="color:#f1fa8c">&#x27;amount&#x27;</span><span class="token punctuation" style="color:#f8f8f2">:</span><span class="token plain"> </span><span class="token builtin" style="color:#bd93f9">float</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">raw_data</span><span class="token punctuation" style="color:#f8f8f2">[</span><span class="token string" style="color:#f1fa8c">&#x27;data&#x27;</span><span class="token punctuation" style="color:#f8f8f2">]</span><span class="token punctuation" style="color:#f8f8f2">[</span><span class="token string" style="color:#f1fa8c">&#x27;priceUsd&#x27;</span><span class="token punctuation" style="color:#f8f8f2">]</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">}</span><span class="token punctuation" style="color:#f8f8f2">}</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">        </span><span class="token keyword" style="color:#ff79c6">print</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#f1fa8c">&#x27;API request succeeded at time {0}&#x27;</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token builtin" style="color:#bd93f9">format</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">dt</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">datetime</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">utcnow</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">        producer</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">send</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">topic</span><span class="token operator" style="color:#ff79c6">=</span><span class="token string" style="color:#f1fa8c">&quot;topic_ETH&quot;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain">value</span><span class="token operator" style="color:#ff79c6">=</span><span class="token plain">data</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">        </span><span class="token keyword" style="color:#ff79c6">print</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#f1fa8c">&#x27;Sent record to topic at time {}&#x27;</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token builtin" style="color:#bd93f9">format</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">dt</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">datetime</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">utcnow</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token keyword" style="color:#ff79c6">else</span><span class="token punctuation" style="color:#f8f8f2">:</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">        </span><span class="token keyword" style="color:#ff79c6">print</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#f1fa8c">&#x27;Failed API request at time {0}&#x27;</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token builtin" style="color:#bd93f9">format</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">dt</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">datetime</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">utcnow</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    end_time </span><span class="token operator" style="color:#ff79c6">=</span><span class="token plain"> time</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">time</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    time_interval </span><span class="token operator" style="color:#ff79c6">=</span><span class="token plain"> end_time </span><span class="token operator" style="color:#ff79c6">-</span><span class="token plain"> start_time</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token comment" style="color:#6272a4"># setting the API to be queried every 15 seconds</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    time</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">sleep</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token number" style="color:#50fa7b">15</span><span class="token plain"> </span><span class="token operator" style="color:#ff79c6">-</span><span class="token plain"> time_interval</span><span class="token punctuation" style="color:#f8f8f2">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>This Python code queries the CoinCap API in a continuous loop that generates the
market price of ETH every 15 seconds. It then processes this data and sends it
to the Kafka topic <code>topic_ETH</code>, where it can be consumed by QuestDB. The data
schema and payload used here is just an example as it doesn’t utilize some
QuestDB optimizations such as partitions</p><p>You can run this code with the following commands:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI shell"><div tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#f8f8f2;background-color:#262833"><div class="token-line" style="color:#f8f8f2"><span class="token comment" style="color:#6272a4"># move back to the parent directory</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token builtin class-name" style="color:#bd93f9">cd</span><span class="token plain"> </span><span class="token punctuation" style="color:#f8f8f2">..</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token comment" style="color:#6272a4"># Installing needed Python packages</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">pip </span><span class="token function" style="color:#8be9fd">install</span><span class="token plain"> -r requirements.txt</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token comment" style="color:#6272a4"># Run the python code</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">python producer.py</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><blockquote><p>Note: If you are having issues installing the dependencies using the
<code>requirements.txt</code> file, particularly if you are getting a
<code>Microsoft Visual C++</code> error, please check your Python version first. The
Confluent-Kafka-Python package supports a few
<a href="https://github.com/confluentinc/confluent-kafka-python/issues/805" target="_blank" rel="noopener noreferrer">Python versions</a>
on Windows at the time of writing, specifically Python 3.7, 3.8, and 3.9. If
you get an error that <code>librdkafka/rdkafka.h</code> is not found, you can try
following the steps at this
<a href="https://github.com/confluentinc/confluent-kafka-python/issues/180" target="_blank" rel="noopener noreferrer">GitHub Issue</a>.
In our particular case with an Apple M1 we solved this problem by executing</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI questdb-sql"><div tabindex="0" class="prism-code language-questdb-sql codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#f8f8f2;background-color:#262833"><div class="token-line" style="color:#f8f8f2"><span class="token plain">brew install librdkafka</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">export LIBRARY_PATH=/opt/homebrew/Cellar/librdkafka/1.8.2/lib</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">export C_INCLUDE_PATH=/opt/homebrew/Cellar/librdkafka/1.8.2/include</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">pip3 install -r requirements.txt</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div></blockquote><p>With the producer script up and running, you will be collating ETH market prices
every fifteen seconds, where this data will be sent to your Kafka topic. Your
QuestDB instance then automatically updates its database with the data from the
monitored Kafka topic. With this data pipeline and connection in place, your
QuestDB instance will be populated with data at fifteen-seconds intervals.</p><p>Try running the following command a few times to observe the database updating
itself from the Kafka topic:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI sql"><div tabindex="0" class="prism-code language-sql codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#f8f8f2;background-color:#262833"><div class="token-line" style="color:#f8f8f2"><span class="token keyword" style="color:#ff79c6">SELECT</span><span class="token plain"> </span><span class="token operator" style="color:#ff79c6">*</span><span class="token plain"> </span><span class="token keyword" style="color:#ff79c6">FROM</span><span class="token plain"> </span><span class="token string" style="color:#f1fa8c">&#x27;topic_ETH&#x27;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p><img src="https://i.imgur.com/6yj1dU1.png" alt="QuestDB result"></p><p>With the data on your QuestDB instance, you can query or modify it and even
generate more records to be sent to other Kafka topics, creating materialized
views and key performance indicators from your data.</p><blockquote><p>Note: To take down the installed containers used in this article, move to the
<code>coincap_kafka_questdb/docker</code> directory and run the following command:</p></blockquote><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI shell"><div tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#f8f8f2;background-color:#262833"><div class="token-line" style="color:#f8f8f2"><span class="token plain">docker-compose down</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="conclusion"></a>Conclusion<a class="hash-link" href="#conclusion" title="Direct link to heading">#</a></h2><p>Data pipelines are a central consideration in the effective movement and
transformation of data for your use. To efficiently collate raw data from where
they are generated and transform this raw data into valuable insights, you need
data pipelines.</p><p>In this article, you learned how to collate data with Kafka and implement a data
pipeline that collects real-time ETH market data and stores data to QuestDB
through Kafka connections.</p><p><a href="https://github.com/questdb/questdb" target="_blank" rel="noopener noreferrer"><em>QuestDB</em></a> is an open source SQL database
with a focus on fast performance and ease of use. It is an optimized storage for
high-volume time series data, whether from your financial services or sensor
applications, where time series data are constantly being generated. It
satisfies the need for high-performance ingestion and query times. Used in
conjunction with Kafka, you can aggregate data from multiple sources, modify
them, and store them for use at a constantly-updating rate that fits your end
user or application.</p></div><footer class="row margin-vert--lg"><div class="col"><strong>Tags:</strong><a class="margin-horiz--sm" href="/blog/tags/tutorial">tutorial</a><a class="margin-horiz--sm" href="/blog/tags/python">python</a><a class="margin-horiz--sm" href="/blog/tags/kafka">kafka</a><a class="margin-horiz--sm" href="/blog/tags/cryptocurrency">cryptocurrency</a><a class="margin-horiz--sm" href="/blog/tags/eth">eth</a><a class="margin-horiz--sm" href="/blog/tags/data-science">data science</a><a class="margin-horiz--sm" href="/blog/tags/market-data">market data</a></div></footer></article><div></div><div class="margin-vert--xl"><nav class="pagination-nav" aria-label="Blog post page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/blog/2022/06/20/forecasting-with-questdb-and-tensorflow"><div class="pagination-nav__sublabel">Newer Post</div><div class="pagination-nav__label">« Time Series Forecasting with TensorFlow and QuestDB</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/blog/2022/05/31/questdb-release-6-4"><div class="pagination-nav__sublabel">Older Post</div><div class="pagination-nav__label">QuestDB 6.4 Release Highlights »</div></a></div></nav></div></main></div></div><div class="root_0lLS"><div class="cards_xeZk"><div class="root_R798 skinPrimary_JHOH"><svg width="76" height="76" viewBox="0 0 76 76" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="38" cy="38" r="38" fill="#1E1F27"></circle><path d="M56.99 18.792a.817.817 0 00-.117-.303c-.01-.02-.02-.05-.03-.069-.01-.02-.029-.029-.048-.049a.912.912 0 00-.137-.136l-.117-.088c-.02-.01-.03-.03-.05-.04-.029-.01-.068-.029-.107-.039a.85.85 0 00-.146-.049 1.075 1.075 0 00-.176-.019h-.147a1.15 1.15 0 00-.196.049c-.029.01-.068.01-.097.02L12.59 36.67a.979.979 0 00-.509 1.29c.098.216.264.401.48.5l16.07 7.556v15.025c0 .537.44.977.978.977a.964.964 0 00.831-.469l6.794-11.046 10.499 5.533a.974.974 0 001.408-.655l7.84-36.2v-.058c.01-.058.01-.107.019-.156 0-.059 0-.117-.01-.176zM29.413 44.208L15.376 37.6l36.326-15.68-22.289 22.288zm1.174 13.363V47.004l4.917 2.59-4.917 7.977zm16.92-3.87l-9.237-4.86-1.662-1.026-.068.118-5.289-2.786 23.1-23.12L47.508 53.7z" fill="#fff"></path></svg><h3 class="title_BHe0">문의하기</h3><p class="description_Bwvi">이메일을 입력하시면 소개자료를 보내드립니다.</p><div class="content_gAr2"><form class="root_teCd"><div><div class="inputs_0wQ8"><input type="email" class="input_cjQx input_a6pP" name="email" required="" pattern="^[a-zA-Z0-9.!#$%&amp;&#x27;*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+$" placeholder="Email address" title="Email address should be valid"><button class="submit_poRs button_f7Ff button--tertiary_vtfp button--uppercase_ESEN" type="submit">보내기</button></div></div></form></div></div></div></div></div><footer class="root_JnvJ"><div class="content_-gfC center_S24y"><img alt="QuestDB logo" class="logo_JrwJ" src="/img/navbar/tp_brand.png" width="108" height="27"><div class="tagline_T1tH"><p>인프라관리부터 서비스운영까지 클라우드환경에 최적화된 클라우드 네이티브 플랫폼</p></div><div class="links_1SgP"></div></div><div class="border_PW0V"><div class="bottom_wPs3 center_S24y">Copyright © 2023 Gitple. All rights are reserved.</div></div></footer></div>
<script src="/assets/js/main.e53824dd.js" defer="defer"></script>
</body>
</html>