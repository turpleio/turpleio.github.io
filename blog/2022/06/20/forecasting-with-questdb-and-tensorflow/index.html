<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=3">
<meta httpequiv="x-ua-compatible" content="ie=edge">
<meta property="og:type" content="website">
<meta name="author" content="turpleio">
<meta name="generator" content="Docusaurus v2.0.0-alpha.75">
<link href="https://www.googletagmanager.com" rel="dns-prefetch">
<link href="https://www.google-analytics.com" rel="dns-prefetch">
<link rel="icon" href="/favicon.png">
<link rel="apple-touch-icon" href="/img/icons/apple-180x180.png" sizes="180x180">
<meta name="msapplication-config" content="/browserconfig.xml">
<link rel="sitemap" type="application/xml" href="/sitemap.xml">
<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=GTM-PVR7M2G"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","GTM-PVR7M2G",{anonymize_ip:!0})</script>
<link rel="search" type="application/opensearchdescription+xml" title="Turple: Cloud Native Platform" href="/opensearch.xml">
<link rel="manifest" href="/manifest.webmanifest">
<meta name="theme-color" content="#d14671">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#21222c">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Turple: Cloud Native Platform Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Turple: Cloud Native Platform Blog Atom Feed"><title data-react-helmet="true">Time Series Forecasting with TensorFlow and QuestDB | Turple: Cloud Native Platform</title><meta data-react-helmet="true" property="og:title" content="Time Series Forecasting with TensorFlow and QuestDB | Turple: Cloud Native Platform"><meta data-react-helmet="true" name="description" content="Timeseries is a type of data used to train machine learning models. You may have numerical data for predicting housing prices or classification data for categorizing dog and cat breeds. It&#x27;s also the special type of data used for training machine learning algorithms where time is the crucial component."><meta data-react-helmet="true" name="twitter:description" content="Timeseries is a type of data used to train machine learning models. You may have numerical data for predicting housing prices or classification data for categorizing dog and cat breeds. It&#x27;s also the special type of data used for training machine learning algorithms where time is the crucial component."><meta data-react-helmet="true" property="og:description" content="Timeseries is a type of data used to train machine learning models. You may have numerical data for predicting housing prices or classification data for categorizing dog and cat breeds. It&#x27;s also the special type of data used for training machine learning algorithms where time is the crucial component."><meta data-react-helmet="true" name="twitter:title" content="Time Series Forecasting with TensorFlow and QuestDB | Turple: Cloud Native Platform"><meta data-react-helmet="true" name="twitter:image:alt" content="Image for &quot;Time Series Forecasting with TensorFlow and QuestDB | Turple: Cloud Native Platform&quot;"><meta data-react-helmet="true" name="keywords" content="python,finance,timeseries,tensorflow,machine learning"><meta data-react-helmet="true" property="og:image" content="https://turpleio.github.io/img/blog/2022-06-20/banner.png"><meta data-react-helmet="true" name="twitter:image" content="https://turpleio.github.io/img/blog/2022-06-20/banner.png"><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><link rel="stylesheet" href="/assets/css/styles.4f6557e4.css">
</head>
<body itemscope itemtype="http://schema.org/Organization">
<meta itemprop="name" content="Turple: Cloud Native Platform">
<meta itemprop="description" content="Turple is a cloud native platform which can help you build and operate your services on cloud.">
<meta itemprop="url" content="https://turpleio.github.io">
<meta itemprop="logo" content="https://turpleio.github.io/img/favicon.png">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}()</script><div id="__docusaurus">
<nav class="navbar navbar_wBc8 navbar--light"><div class="navbar__inner inner_Y8Z6"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand brand_AtiA" href="/">QuestDB</a><a class="navbar__item navbar__link" href="/docs/">Docs</a></div><div class="navbar__items navbar__items--right"></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand brand_AtiA" href="/">QuestDB</a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/">Docs</a></li></ul></div></div></div></nav><div class="wrapper_DIJ0 blog-wrapper"><div class="container margin-vert--lg"><div class="row"><div class="col col--3"><div class="sidebar_q+wC thin-scrollbar"><h3 class="sidebarItemTitle_9G5K">Recent posts</h3><ul class="sidebarItemList_6T4b"><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/blog/2022/12/19/merry-questmas-gifts-2023">Merry Questmas! Here are your gifts for 2023...</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/blog/2022/12/13/using-prometheus-loki-grafana-monitor-questdb-kubernetes">Using Prometheus, Loki, and Grafana to monitor QuestDB in Kubernetes</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/blog/2022/11/30/full-table-scan-are-fast">Listen to Your CPU - Full-table Scans Are Fast</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/blog/2022/11/25/questdb-6.6.1-dynamic-commits">QuestDB 6.6.1 - Dynamic Commits</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/blog/2022/11/23/sql-extensions-time-series-data-questdb-part-ii">SQL Extensions for Time Series Data in QuestDB - Part II</a></li></ul></div></div><main class="col col--7"><article><header><h1 class="title_KBQu">Time Series Forecasting with TensorFlow and QuestDB</h1><time datetime="2022-06-20T00:00:00.000Z" class="date_A31P">June 20, 2022 · 15 min read</time><div class="avatar margin-vert--md"><a href="https://www.linkedin.com/in/gourav-singh-bais/" target="_blank" rel="noopener noreferrer" class="avatar__photo-link avatar__photo"><img src="https://assets-global.website-files.com/5fbfbba70f3f813561ef7b9f/620d4da15af10f3600a93e38_g.jpg" alt="Gourav Singh Bais"></a><div class="avatar__intro"><h4 class="avatar__name"><a href="https://www.linkedin.com/in/gourav-singh-bais/" target="_blank" rel="noopener noreferrer">Gourav Singh Bais</a></h4><small class="avatar__subtitle">Guest post</small></div></div></header><div class="markdown"><p>This post is contributed by
<a href="https://www.linkedin.com/in/gourav-singh-bais/" target="_blank" rel="noopener noreferrer">Gourav Singh Bais</a>, who has
written an excellent tutorial that shows how to build an application that uses
time series data to forecast trends and events using Tensorflow and QuestDB.
Thanks for the submission!</p><figure><img alt="QuestDB log and Tensorflow logo" class="image_1-Fc" height="467" src="/img/blog/2022-06-20/banner.png" width="650"></figure><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="machine-learning-for-timeseries-forecasting"></a>Machine Learning for Timeseries Forecasting<a class="hash-link" href="#machine-learning-for-timeseries-forecasting" title="Direct link to heading">#</a></h2><p>Machine learning is taking the world by storm, performing many tasks with
human-like accuracy. In the medical field, there are now smart assistants that
can check your health over time. In finance, there are tools that can predict
the return on your investment with a reasonable degree of accuracy. In online
marketing, there are product recommenders that suggest specific products and
brands based on your purchase history.</p><p>In each of these fields, a different type of data can be used to train machine
learning models. Among them, <em>time series data</em> is used for training machine
learning algorithms where time is the crucial component.</p><p>Time series data is complex and involves time-dependent features that go beyond
the scope of what traditional machine learning algorithms like Regression,
Classification, and Clustering are useful for. Thankfully, there are machine
learning models we can use for <strong>time series forecasting</strong>. Predictions resulted
from time series forecasting may not be wholly precise due to the variable
nature of time, but they do provide reasonable approximations that are
applicable in a variety of fields. Let’s consider a few use cases:</p><ul><li><p><strong>Predictive maintenance:</strong> nowadays, IoT (internet of things), AI (artificial
intelligence), and integrated systems are being embedded into electronic,
mechanical, and other types of devices to make them smart. These IoT devices
have sensors to keep track of relevant values over time; and artificial
intelligence, of which time series forecasting is a component, is used to
analyze this data and make predictions regarding the approximate time at which
devices may need maintenance.</p></li><li><p><strong>Anomaly detection:</strong> the process of detecting the rare events and
observations in the functionality of systems. Identifying these events can be
rather challenging, but time series forecasting helps by providing smart
elements that can monitor things continuously. Cyber security, health
monitoring, and fraud detection in FinTech are a few examples of systems that
make use of time series analysis for anomaly detection.</p></li><li><p><strong>IoT data:</strong>
<a href="https://oracle.com/in/internet-of-things/what-is-iot/" target="_blank" rel="noopener noreferrer">internet of things</a> is
now becoming a concrete pillar of our economy. IoT devices have the ability to
store data on a timely basis and communicate it across other devices for
analysis and forecasting. One example of this is temperature prediction, in
which different IoT devices are used to regularly store temperature data,
while forecasting is then used to make weather-related predictions and
decisions.</p></li><li><p><strong>Autoscaling decisions:</strong> With time series forecasting, businesses can better
monitor the demand for their products or solutions over time and anticipate
future demand in time to scale their services accordingly.</p></li><li><p><strong>Trading:</strong> Every day when the stock market opens and closes, entries are
made for fluctuations in seconds. A variety of databases and file storage
systems are used to store all of this information, and different time series
forecasting algorithms can then be used to make price forecasts for the
upcoming day, week, or even month.</p></li></ul><p>In this article, we will build and train a simple machine learning model that
uses time series data to forecast trends and events using
<a href="https://www.tensorflow.org/" target="_blank" rel="noopener noreferrer">TensorFlow</a> and <a href="https://questdb.io/" target="_blank" rel="noopener noreferrer">QuestDB</a>.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="tensorflow-and-questdb"></a>TensorFlow and QuestDB<a class="hash-link" href="#tensorflow-and-questdb" title="Direct link to heading">#</a></h2><p>Time series forecasting can be carried out in different ways, including using
various of machine learning algorithms like
<a href="https://machinelearningmastery.com/arima-for-time-series-forecasting-with-python/" target="_blank" rel="noopener noreferrer">ARIMA</a>,
<a href="https://ai.plainenglish.io/time-series-decomposition-ets-model-using-python-4d2cd04bab77" target="_blank" rel="noopener noreferrer">ETS</a>,
<a href="https://machinelearningmastery.com/exponential-smoothing-for-time-series-forecasting-in-python/#:~:text=Single%20Exponential%20Smoothing%2C%20SES%20for,smoothing%20factor%20or%20smoothing%20coefficient." target="_blank" rel="noopener noreferrer">Simple Exponential Smoothing</a>,
and
<a href="https://towardsdatascience.com/temporal-loops-intro-to-recurrent-neural-networks-for-time-series-forecasting-in-python-b0398963dc1f" target="_blank" rel="noopener noreferrer">Recurrent Neural Network (RNN)</a>.
The RNN is a deep learning method with multiple variations itself such as
<a href="https://machinelearningmastery.com/time-series-prediction-lstm-recurrent-neural-networks-python-keras/" target="_blank" rel="noopener noreferrer">LSTM</a>
and
<a href="https://towardsdatascience.com/predictive-analytics-time-series-forecasting-with-gru-and-bilstm-in-tensorflow-87588c852915" target="_blank" rel="noopener noreferrer">GRU</a>.
These RNNs have feedback loops between the layers of the neural network. This
makes them ideal choices for timeseries forecasting as the network can
‘remember’ for previous data. The implementation of these deep learning
algorithms is made easier with the use of Google’s
<a href="https://www.tensorflow.org/" target="_blank" rel="noopener noreferrer">TensorFlow</a> library, which supports all kinds of
neural networks and deep learning algorithms.</p><p>The heart of any algorithm is the data, and that’s no different for time series
forecasting. <strong>Time Series Databases</strong> (TSDBs) provide
<a href="https://questdb.io/blog/2020/11/26/why-timeseries-data/" target="_blank" rel="noopener noreferrer">a lot more features</a>
for storing and analyzing time series data as compared to traditional databases.
For this tutorial, my choice of TSDBs is <a href="https://questdb.io/" target="_blank" rel="noopener noreferrer"><em>QuestDB</em></a>, an
open source time series database with a focus on fast performance and ease of
use.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="implementing-predictive-data-analysis"></a>Implementing Predictive Data Analysis<a class="hash-link" href="#implementing-predictive-data-analysis" title="Direct link to heading">#</a></h2><p>Now that you have a deeper awareness of time series data and time series
analysis, let’s dive into a practical implementation by building an application
to use this data for forecasting trends. This tutorial will use the historical
exchange rate of USD to the INR data set, which you can download
<a href="https://excelrates.com/historical-exchange-rates/USD-INR" target="_blank" rel="noopener noreferrer">here</a> in Excel
format. Make sure you select the time span between 1999-2022. This data set
contains three columns:</p><ol><li><strong>Date:</strong> time component that represents date of exchange rate.</li><li><strong>USD:</strong> price of USD in USD (constant 1.0).</li><li><strong>INR:</strong> price of USD in INR on the specific date.</li></ol><p>As you have read, there are many different options for time series forecasting
(e.g., ARIMA, ETS, Simple Exponential Smoothing, RNNs, LSTMs, GRUs, etc.). This
article will focus on the deep learning solution—using neural networks to
accomplish time series forecasting. Using RNNs for a small amount of data can
cause an issue called
<a href="https://en.wikipedia.org/wiki/Vanishing_gradient_problem" target="_blank" rel="noopener noreferrer">vanishing gradient</a>.
Because of this reason, LSTMs and GRUs were introduced. Due to its architectural
simplicity, GRU is the best option for the small amount of data you’ll be using
in this tutorial.</p><p>Let’s get started!</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="installing-tensorflow"></a>Installing TensorFlow<a class="hash-link" href="#installing-tensorflow" title="Direct link to heading">#</a></h3><p>TensorFlow can be easily installed with a Python package manager (PIP). Be sure
to use Python 3.6 for best compatibility with TensorFlow 1.15 (as well as later
versions). If you have <a href="https://www.anaconda.com/" target="_blank" rel="noopener noreferrer">Anaconda</a> installed in your
system, you can use the Anaconda prompt. For normal Python installation, you can
use the default command prompt and write the following command to install
TensorFlow:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI shell"><div tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#f8f8f2;background-color:#262833"><div class="token-line" style="color:#f8f8f2"><span class="token plain">pip </span><span class="token function" style="color:#8be9fd">install</span><span class="token plain"> tensorflow</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><blockquote><p>Note: If you are using MacOs and get a pip error, try running instead
<code>pip install tensorflow-macos</code></p></blockquote><p>Now we need to install a few dependencies, unless you already have them locally:</p><p><code>pip install jupyter pandas numpy scikit-learn matplotlib openpyxl</code></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="installing-questdb"></a>Installing QuestDB<a class="hash-link" href="#installing-questdb" title="Direct link to heading">#</a></h3><p>To install QuestDB on any OS platform, you’ll need to:</p><ol><li><p><a href="https://docs.docker.com/engine/install/" target="_blank" rel="noopener noreferrer">Install Docker</a></p></li><li><p>Pull the QuestDB Docker image and create a Docker container. Open your
command prompt and write the following command:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI shell"><div tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#f8f8f2;background-color:#262833"><div class="token-line" style="color:#f8f8f2"><span class="token plain">docker run -p </span><span class="token number" style="color:#50fa7b">9000</span><span class="token plain">:9000 -p </span><span class="token number" style="color:#50fa7b">8812</span><span class="token plain">:8812 questdb/questdb</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div></li></ol><p>Here, 9000 is the port on which QuestDB will run, and port 8812 is for the
Postgres wire protocol.</p><ol start="3"><li><p>Open another terminal and run the following command to check whether QuestDB
is running or not:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI shell"><div tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#f8f8f2;background-color:#262833"><div class="token-line" style="color:#f8f8f2"><span class="token plain">docker </span><span class="token function" style="color:#8be9fd">ps</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div></li></ol><p>Alternatively, you can browse <strong>localhost:9000</strong>, and QuestDB should be
accessible there.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="importing-your-dependencies"></a>Importing Your Dependencies<a class="hash-link" href="#importing-your-dependencies" title="Direct link to heading">#</a></h3><p>Now that your dependencies are installed, it’s time to start implementing the
time series forecasting with TensorFlow and QuestDB. If you want to clone the
project and follow along in your own <a href="https://jupyter.org/" target="_blank" rel="noopener noreferrer">Jupyter</a> notebook,
<a href="https://github.com/gouravsinghbais/Time-Series-Forecasting-with-Tensorflow-and-QuestDB" target="_blank" rel="noopener noreferrer">here is the link</a>
to the GitHub repo.</p><p>We start our local jupyter environment by running:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI questdb-sql"><div tabindex="0" class="prism-code language-questdb-sql codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#f8f8f2;background-color:#262833"><div class="token-line" style="color:#f8f8f2"><span class="token plain">jupyter notebook</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>First, we import the following dependencies:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI python"><div tabindex="0" class="prism-code language-python codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#f8f8f2;background-color:#262833"><div class="token-line" style="color:#f8f8f2"><span class="token comment" style="color:#6272a4">## import dependencies</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#ff79c6">import</span><span class="token plain"> numpy </span><span class="token keyword" style="color:#ff79c6">as</span><span class="token plain"> np</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#ff79c6">import</span><span class="token plain"> pandas </span><span class="token keyword" style="color:#ff79c6">as</span><span class="token plain"> pd</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token comment" style="color:#6272a4">## deep learning dependencies</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token triple-quoted-string string" style="color:#f1fa8c">&#x27;&#x27;&#x27;</span></div><div class="token-line" style="color:#f8f8f2"><span class="token triple-quoted-string string" style="color:#f1fa8c">In case you are using python version &gt; 3.6</span></div><div class="token-line" style="color:#f8f8f2"><span class="token triple-quoted-string string" style="color:#f1fa8c">you should import model dependencies from</span></div><div class="token-line" style="color:#f8f8f2"><span class="token triple-quoted-string string" style="color:#f1fa8c">tensorflow directly instead of keras</span></div><div class="token-line" style="color:#f8f8f2"><span class="token triple-quoted-string string" style="color:#f1fa8c">eg. from tensorflow.keras.optimizers import *</span></div><div class="token-line" style="color:#f8f8f2"><span class="token triple-quoted-string string" style="color:#f1fa8c">&#x27;&#x27;&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#ff79c6">from</span><span class="token plain"> sklearn</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">preprocessing </span><span class="token keyword" style="color:#ff79c6">import</span><span class="token plain"> MinMaxScaler</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#ff79c6">from</span><span class="token plain"> keras</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">models </span><span class="token keyword" style="color:#ff79c6">import</span><span class="token plain"> Sequential</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#ff79c6">from</span><span class="token plain"> keras</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">layers </span><span class="token keyword" style="color:#ff79c6">import</span><span class="token plain"> </span><span class="token operator" style="color:#ff79c6">*</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#ff79c6">from</span><span class="token plain"> keras</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">optimizers </span><span class="token keyword" style="color:#ff79c6">import</span><span class="token plain"> </span><span class="token operator" style="color:#ff79c6">*</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token comment" style="color:#6272a4">## QuestDB dependencies</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#ff79c6">import</span><span class="token plain"> io</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#ff79c6">import</span><span class="token plain"> requests</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#ff79c6">import</span><span class="token plain"> urllib</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">parse </span><span class="token keyword" style="color:#ff79c6">as</span><span class="token plain"> par</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token comment" style="color:#6272a4">## timestamp dependencies</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#ff79c6">from</span><span class="token plain"> datetime </span><span class="token keyword" style="color:#ff79c6">import</span><span class="token plain"> datetime</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token comment" style="color:#6272a4">## visualisation dependencies</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#ff79c6">import</span><span class="token plain"> matplotlib</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">pyplot </span><span class="token keyword" style="color:#ff79c6">as</span><span class="token plain"> plt</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token operator" style="color:#ff79c6">%</span><span class="token plain">matplotlib inline</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="reading-the-data-set"></a>Reading the Data Set<a class="hash-link" href="#reading-the-data-set" title="Direct link to heading">#</a></h3><p>Once you have imported all the computation, deep learning, and visualization
dependencies, you can go ahead and read the data set we downloaded earlier:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI python"><div tabindex="0" class="prism-code language-python codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#f8f8f2;background-color:#262833"><div class="token-line" style="color:#f8f8f2"><span class="token comment" style="color:#6272a4"># read dataset using pandas library</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">df </span><span class="token operator" style="color:#ff79c6">=</span><span class="token plain"> pd</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">read_excel</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#f1fa8c">&#x27;Excelrates.xlsx&#x27;</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token comment" style="color:#6272a4">## check first few rows of the dataset</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">df</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">head</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token punctuation" style="color:#f8f8f2">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>Since the data set that you want to read is an Excel file, you will have to use
the <code>read_excel()</code> function provided by the <a href="https://pandas.pydata.org/" target="_blank" rel="noopener noreferrer">pandas</a>
library. Once the data set is read, you can check its first few rows with the
help of the <code>head()</code> function. Your data set should look something like this:</p><p><img alt="Read Dataset" src="/assets/images/read-dataset-8c6e18b2d1c6ef6ce5021b65bef4e57f.png"></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="creating-questdb-tables"></a>Creating QuestDB Tables<a class="hash-link" href="#creating-questdb-tables" title="Direct link to heading">#</a></h3><p>Now you’ve seen your data set, but Excel is limited in its ability to store
large amounts of data. Thus, you’ll use QuestDB to store the time series data
instead. To do so, first make sure the QuestDB Docker container is running and
accessible:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI python"><div tabindex="0" class="prism-code language-python codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#f8f8f2;background-color:#262833"><div class="token-line" style="color:#f8f8f2"><span class="token comment" style="color:#6272a4">## create table query</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">q </span><span class="token operator" style="color:#ff79c6">=</span><span class="token plain"> </span><span class="token triple-quoted-string string" style="color:#f1fa8c">&#x27;&#x27;&#x27;create table excel_rates (</span></div><div class="token-line" style="color:#f8f8f2"><span class="token triple-quoted-string string" style="color:#f1fa8c">           Date timestamp,</span></div><div class="token-line" style="color:#f8f8f2"><span class="token triple-quoted-string string" style="color:#f1fa8c">           USD int,</span></div><div class="token-line" style="color:#f8f8f2"><span class="token triple-quoted-string string" style="color:#f1fa8c">           INR double)&#x27;&#x27;&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token comment" style="color:#6272a4">## connect to QuestDB URL and execute the query</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">r </span><span class="token operator" style="color:#ff79c6">=</span><span class="token plain"> requests</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">get</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#f1fa8c">&quot;http://localhost:9000/exec?query=&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#ff79c6">+</span><span class="token plain"> q</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token comment" style="color:#6272a4">## print the status code once executed the table creation query</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#ff79c6">print</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">r</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">status_code</span><span class="token punctuation" style="color:#f8f8f2">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>Creating a table in QuestDB involves the same process as creating the table in
any other database like SQL, Oracle, NoSQL, etc. Simply provide the table name,
column names, and their respective data types. Then, connect to the port where
QuestDB is running (in this case, port 9000) and execute the query using the
request module of Python. If the query execution is successful, it will return
the status code <strong>200</strong>; if not, you will receive the status code <strong>400</strong>.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="inserting-the-data-to-questdb"></a>Inserting the Data to QuestDB<a class="hash-link" href="#inserting-the-data-to-questdb" title="Direct link to heading">#</a></h3><p>Once you have created the table, you need to store your data in it. Use the
following code to do so:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI python"><div tabindex="0" class="prism-code language-python codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#f8f8f2;background-color:#262833"><div class="token-line" style="color:#f8f8f2"><span class="token comment" style="color:#6272a4">## variables for tracking successful execution of queries</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">success </span><span class="token operator" style="color:#ff79c6">=</span><span class="token plain"> </span><span class="token number" style="color:#50fa7b">0</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">fail </span><span class="token operator" style="color:#ff79c6">=</span><span class="token plain"> </span><span class="token number" style="color:#50fa7b">0</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token comment" style="color:#6272a4">## iterate over each row and store it in the QuestDB table</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#ff79c6">for</span><span class="token plain"> i</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> row </span><span class="token keyword" style="color:#ff79c6">in</span><span class="token plain"> df</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">iterrows</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">:</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    date </span><span class="token operator" style="color:#ff79c6">=</span><span class="token plain"> row</span><span class="token punctuation" style="color:#f8f8f2">[</span><span class="token string" style="color:#f1fa8c">&#x27;Date&#x27;</span><span class="token punctuation" style="color:#f8f8f2">]</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token comment" style="color:#6272a4">## convert date to datetime format to store in DB</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    date </span><span class="token operator" style="color:#ff79c6">=</span><span class="token plain"> </span><span class="token string" style="color:#f1fa8c">&quot;&#x27;&quot;</span><span class="token operator" style="color:#ff79c6">+</span><span class="token plain">date</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">strftime</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#f1fa8c">&#x27;%Y-%m-%dT%H:%M:%S.%fZ&#x27;</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token operator" style="color:#ff79c6">+</span><span class="token string" style="color:#f1fa8c">&quot;&#x27;&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    usd </span><span class="token operator" style="color:#ff79c6">=</span><span class="token plain"> row</span><span class="token punctuation" style="color:#f8f8f2">[</span><span class="token string" style="color:#f1fa8c">&#x27;USD&#x27;</span><span class="token punctuation" style="color:#f8f8f2">]</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    inr </span><span class="token operator" style="color:#ff79c6">=</span><span class="token plain"> row</span><span class="token punctuation" style="color:#f8f8f2">[</span><span class="token string" style="color:#f1fa8c">&#x27;INR&#x27;</span><span class="token punctuation" style="color:#f8f8f2">]</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">        query </span><span class="token operator" style="color:#ff79c6">=</span><span class="token plain"> </span><span class="token string-interpolation string" style="color:#f1fa8c">f&#x27;insert into excel_rates values(</span><span class="token string-interpolation interpolation punctuation" style="color:#f8f8f2">{</span><span class="token string-interpolation interpolation">date</span><span class="token string-interpolation interpolation punctuation" style="color:#f8f8f2">}</span><span class="token string-interpolation string" style="color:#f1fa8c">, </span><span class="token string-interpolation interpolation punctuation" style="color:#f8f8f2">{</span><span class="token string-interpolation interpolation">usd</span><span class="token string-interpolation interpolation punctuation" style="color:#f8f8f2">}</span><span class="token string-interpolation string" style="color:#f1fa8c">, </span><span class="token string-interpolation interpolation punctuation" style="color:#f8f8f2">{</span><span class="token string-interpolation interpolation">inr</span><span class="token string-interpolation interpolation punctuation" style="color:#f8f8f2">}</span><span class="token string-interpolation string" style="color:#f1fa8c">)&#x27;</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    r </span><span class="token operator" style="color:#ff79c6">=</span><span class="token plain"> requests</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">get</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#f1fa8c">&quot;http://localhost:9000/exec?query=&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#ff79c6">+</span><span class="token plain"> query</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token keyword" style="color:#ff79c6">if</span><span class="token plain"> r</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">status_code </span><span class="token operator" style="color:#ff79c6">==</span><span class="token plain"> </span><span class="token number" style="color:#50fa7b">200</span><span class="token punctuation" style="color:#f8f8f2">:</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">        success </span><span class="token operator" style="color:#ff79c6">+=</span><span class="token plain"> </span><span class="token number" style="color:#50fa7b">1</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token keyword" style="color:#ff79c6">else</span><span class="token punctuation" style="color:#f8f8f2">:</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">        fail </span><span class="token operator" style="color:#ff79c6">+=</span><span class="token plain"> </span><span class="token number" style="color:#50fa7b">1</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token comment" style="color:#6272a4">## check if the execution is successful or not</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#ff79c6">if</span><span class="token plain"> fail </span><span class="token operator" style="color:#ff79c6">&gt;</span><span class="token plain"> </span><span class="token number" style="color:#50fa7b">0</span><span class="token punctuation" style="color:#f8f8f2">:</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token keyword" style="color:#ff79c6">print</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#f1fa8c">&quot;Rows Failed: &quot;</span><span class="token plain"> </span><span class="token operator" style="color:#ff79c6">+</span><span class="token plain"> </span><span class="token builtin" style="color:#bd93f9">str</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">fail</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token keyword" style="color:#ff79c6">if</span><span class="token plain"> success </span><span class="token operator" style="color:#ff79c6">&gt;</span><span class="token plain"> </span><span class="token number" style="color:#50fa7b">0</span><span class="token punctuation" style="color:#f8f8f2">:</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">    </span><span class="token keyword" style="color:#ff79c6">print</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#f1fa8c">&quot;Rows inserted: &quot;</span><span class="token plain"> </span><span class="token operator" style="color:#ff79c6">+</span><span class="token plain"> </span><span class="token builtin" style="color:#bd93f9">str</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">success</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>To store data in QuestDB tables, you need to use the <strong>insert</strong> query. As shown
above, iterate over each row in the data frame and insert the Date, USD, and INR
columns in the database. If all the rows are inserted successfully, you will
receive code <strong>200</strong>; if any of them fails, you’ll get code <strong>400</strong>.</p><p><strong>Note:</strong> error code 400 may be returned due to a data type mismatch. For
DateTime, make sure your date is enclosed in single quotes.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="selecting-the-data-from-questdb"></a>Selecting the Data from QuestDB<a class="hash-link" href="#selecting-the-data-from-questdb" title="Direct link to heading">#</a></h3><p>One of the great things about reading data from a database, rather than directly
from a file, is that we can easily run queries running filters or aggregations.
For the purpose of this tutorial, instead of reading the whole dataset (over
17000 rows, we will select only three years, representing about 2200 rows. Feel
free to comment out the filter to compare if our model is predicting better when
we train with a larger dataset.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI python"><div tabindex="0" class="prism-code language-python codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#f8f8f2;background-color:#262833"><div class="token-line" style="color:#f8f8f2"><span class="token comment" style="color:#6272a4">## select data from QuestDB</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">r </span><span class="token operator" style="color:#ff79c6">=</span><span class="token plain"> requests</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">get</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#f1fa8c">&quot;http://localhost:9000/exp?query=select * from excel_rates where Date in (&#x27;2022&#x27;) or Date in (&#x27;2021&#x27;) or Date in (&#x27;2020&#x27;)&quot;</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">rawData </span><span class="token operator" style="color:#ff79c6">=</span><span class="token plain"> r</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">text</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token comment" style="color:#6272a4">## convert Bytes to CSV format and read using pandas library</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">df </span><span class="token operator" style="color:#ff79c6">=</span><span class="token plain"> pd</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">read_csv</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">io</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">StringIO</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">rawData</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> parse_dates</span><span class="token operator" style="color:#ff79c6">=</span><span class="token punctuation" style="color:#f8f8f2">[</span><span class="token string" style="color:#f1fa8c">&#x27;Date&#x27;</span><span class="token punctuation" style="color:#f8f8f2">]</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">df</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">columns</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>Here, in order to retrieve the data from QuestDB, you need to use the <code>select</code>
query. The output of the select query is a byte array that represents the data.
Once the data is retrieved, you can read it using the pandas <code>read_csv()</code>
function.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="preprocessing-the-data"></a>Preprocessing the Data<a class="hash-link" href="#preprocessing-the-data" title="Direct link to heading">#</a></h3><p>At this point in the tutorial, you’ve created the table, inserted data into the
table, and read the data from the table. Now, it’s time to do some time series
forecasting preprocessing.</p><p>First, you can go ahead and remove the USD column, as it contains all &#x27;1&#x27;
values, and as such, it will not contribute to the forecasting in any way. To do
so, use the following code:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI python"><div tabindex="0" class="prism-code language-python codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#f8f8f2;background-color:#262833"><div class="token-line" style="color:#f8f8f2"><span class="token comment" style="color:#6272a4">## drop USD column from the dataframe</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">df </span><span class="token operator" style="color:#ff79c6">=</span><span class="token plain"> df</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">drop</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token string" style="color:#f1fa8c">&#x27;USD&#x27;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> axis</span><span class="token operator" style="color:#ff79c6">=</span><span class="token number" style="color:#50fa7b">1</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token comment" style="color:#6272a4">## convert Date column to datetime format</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">df</span><span class="token punctuation" style="color:#f8f8f2">[</span><span class="token string" style="color:#f1fa8c">&#x27;Date&#x27;</span><span class="token punctuation" style="color:#f8f8f2">]</span><span class="token plain"> </span><span class="token operator" style="color:#ff79c6">=</span><span class="token plain"> pd</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">to_datetime</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">df</span><span class="token punctuation" style="color:#f8f8f2">[</span><span class="token string" style="color:#f1fa8c">&quot;Date&quot;</span><span class="token punctuation" style="color:#f8f8f2">]</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token comment" style="color:#6272a4">## set Date as index</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">indexed_df </span><span class="token operator" style="color:#ff79c6">=</span><span class="token plain"> df</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">set_index</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token punctuation" style="color:#f8f8f2">[</span><span class="token string" style="color:#f1fa8c">&quot;Date&quot;</span><span class="token punctuation" style="color:#f8f8f2">]</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> drop</span><span class="token operator" style="color:#ff79c6">=</span><span class="token boolean" style="color:#bd93f9">True</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">indexed_df</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">head</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token punctuation" style="color:#f8f8f2">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>You should now see the DataFrame as follows:</p><p><img alt="Data" src="/assets/images/data-4d6dd4957534e6dd6abdad5c80600ebb.png"></p><p>To see how the value of INR is varying according to time, you can plot a curve
between time and INR using this code:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI python"><div tabindex="0" class="prism-code language-python codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#f8f8f2;background-color:#262833"><div class="token-line" style="color:#f8f8f2"><span class="token comment" style="color:#6272a4">## plot dataframe</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">indexed_df</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">plot</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token punctuation" style="color:#f8f8f2">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>The plot should look something like this:</p><p><img alt="All data set values" src="/assets/images/plot-all-values-10d74f7477658f04b57af76741ff3999.png"></p><p>Time series forecasting is a supervised approach, which means it uses input
features and labels to do forecasting. As of now, you only have Date as an index
and a column (INR) as a feature. To create the label, you need to shift each INR
value by 1 so that INR becomes the input feature, while the shifted values would
be the output feature/label. You’ll also need to remove the NaN values from the
columns to make them suitable for training. Use the following code to do all of
this:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI python"><div tabindex="0" class="prism-code language-python codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#f8f8f2;background-color:#262833"><div class="token-line" style="color:#f8f8f2"><span class="token comment" style="color:#6272a4">## shift INR values by 1</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">shifted_df</span><span class="token operator" style="color:#ff79c6">=</span><span class="token plain"> indexed_df</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">shift</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token comment" style="color:#6272a4">## merge INR and Shifter INR values</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">concat_df </span><span class="token operator" style="color:#ff79c6">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#f8f8f2">[</span><span class="token plain">indexed_df</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> shifted_df</span><span class="token punctuation" style="color:#f8f8f2">]</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">data </span><span class="token operator" style="color:#ff79c6">=</span><span class="token plain"> pd</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">concat</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">concat_df</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain">axis</span><span class="token operator" style="color:#ff79c6">=</span><span class="token number" style="color:#50fa7b">1</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token comment" style="color:#6272a4">## Replace NaNs with 0</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">data</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">fillna</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token number" style="color:#50fa7b">0</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> inplace</span><span class="token operator" style="color:#ff79c6">=</span><span class="token boolean" style="color:#bd93f9">True</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">data</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">head</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token punctuation" style="color:#f8f8f2">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>Once complete, your data set should look like this:</p><p><img alt="Preprocessed data" src="/assets/images/processed-data-fcac1015e6557839d72e720f006b51db.png"></p><p>Next, you need to split the data into two different categories—train and test:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI python"><div tabindex="0" class="prism-code language-python codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#f8f8f2;background-color:#262833"><div class="token-line" style="color:#f8f8f2"><span class="token comment" style="color:#6272a4">## convert data to numpy array</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">data </span><span class="token operator" style="color:#ff79c6">=</span><span class="token plain"> np</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">array</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">data</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token comment" style="color:#6272a4">## you can take last 500 data points as test set</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">train </span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> test </span><span class="token operator" style="color:#ff79c6">=</span><span class="token plain"> data</span><span class="token punctuation" style="color:#f8f8f2">[</span><span class="token number" style="color:#50fa7b">0</span><span class="token punctuation" style="color:#f8f8f2">:</span><span class="token operator" style="color:#ff79c6">-</span><span class="token number" style="color:#50fa7b">500</span><span class="token punctuation" style="color:#f8f8f2">]</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> data</span><span class="token punctuation" style="color:#f8f8f2">[</span><span class="token operator" style="color:#ff79c6">-</span><span class="token number" style="color:#50fa7b">500</span><span class="token punctuation" style="color:#f8f8f2">:</span><span class="token punctuation" style="color:#f8f8f2">]</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>Since there is diversity in the data (values are varying at a large scale), you
need to apply some scaling or normalization to the data. For this purpose, you
will be using <strong>MinMaxScaler</strong>:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI python"><div tabindex="0" class="prism-code language-python codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#f8f8f2;background-color:#262833"><div class="token-line" style="color:#f8f8f2"><span class="token comment" style="color:#6272a4">## Scale</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">scaler </span><span class="token operator" style="color:#ff79c6">=</span><span class="token plain"> MinMaxScaler</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">train_scaled </span><span class="token operator" style="color:#ff79c6">=</span><span class="token plain"> scaler</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">fit_transform</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">train</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">test_scaled </span><span class="token operator" style="color:#ff79c6">=</span><span class="token plain"> scaler</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">transform</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">test</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token comment" style="color:#6272a4">## train data</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">y_train </span><span class="token operator" style="color:#ff79c6">=</span><span class="token plain"> train_scaled</span><span class="token punctuation" style="color:#f8f8f2">[</span><span class="token punctuation" style="color:#f8f8f2">:</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token operator" style="color:#ff79c6">-</span><span class="token number" style="color:#50fa7b">1</span><span class="token punctuation" style="color:#f8f8f2">]</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">X_train </span><span class="token operator" style="color:#ff79c6">=</span><span class="token plain"> train_scaled</span><span class="token punctuation" style="color:#f8f8f2">[</span><span class="token punctuation" style="color:#f8f8f2">:</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token number" style="color:#50fa7b">0</span><span class="token punctuation" style="color:#f8f8f2">:</span><span class="token operator" style="color:#ff79c6">-</span><span class="token number" style="color:#50fa7b">1</span><span class="token punctuation" style="color:#f8f8f2">]</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">X_train </span><span class="token operator" style="color:#ff79c6">=</span><span class="token plain"> X_train</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">reshape</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token builtin" style="color:#bd93f9">len</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">X_train</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token number" style="color:#50fa7b">1</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token number" style="color:#50fa7b">1</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token comment" style="color:#6272a4">## test data</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">y_test </span><span class="token operator" style="color:#ff79c6">=</span><span class="token plain"> test_scaled</span><span class="token punctuation" style="color:#f8f8f2">[</span><span class="token punctuation" style="color:#f8f8f2">:</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token operator" style="color:#ff79c6">-</span><span class="token number" style="color:#50fa7b">1</span><span class="token punctuation" style="color:#f8f8f2">]</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">X_test </span><span class="token operator" style="color:#ff79c6">=</span><span class="token plain"> test_scaled</span><span class="token punctuation" style="color:#f8f8f2">[</span><span class="token punctuation" style="color:#f8f8f2">:</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token number" style="color:#50fa7b">0</span><span class="token punctuation" style="color:#f8f8f2">:</span><span class="token operator" style="color:#ff79c6">-</span><span class="token number" style="color:#50fa7b">1</span><span class="token punctuation" style="color:#f8f8f2">]</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="creating-the-model"></a>Creating the Model<a class="hash-link" href="#creating-the-model" title="Direct link to heading">#</a></h3><p>Now, the preprocessing is complete, and it’s time to train your deep learning
(GRU) model for time series forecasting. Use this code to do so:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI python"><div tabindex="0" class="prism-code language-python codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#f8f8f2;background-color:#262833"><div class="token-line" style="color:#f8f8f2"><span class="token comment" style="color:#6272a4">## GRU Model</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">model </span><span class="token operator" style="color:#ff79c6">=</span><span class="token plain"> Sequential</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token comment" style="color:#6272a4">## GRU layer</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">model</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">add</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">GRU</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token number" style="color:#50fa7b">75</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> input_shape</span><span class="token operator" style="color:#ff79c6">=</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token number" style="color:#50fa7b">1</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token number" style="color:#50fa7b">1</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token comment" style="color:#6272a4">## output layer</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">model</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">add</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">Dense</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token number" style="color:#50fa7b">1</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">optimizer </span><span class="token operator" style="color:#ff79c6">=</span><span class="token plain"> Adam</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">lr</span><span class="token operator" style="color:#ff79c6">=</span><span class="token number" style="color:#50fa7b">1e</span><span class="token operator" style="color:#ff79c6">-</span><span class="token number" style="color:#50fa7b">3</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">model</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token builtin" style="color:#bd93f9">compile</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">loss</span><span class="token operator" style="color:#ff79c6">=</span><span class="token string" style="color:#f1fa8c">&#x27;mean_squared_error&#x27;</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> optimizer</span><span class="token operator" style="color:#ff79c6">=</span><span class="token plain">optimizer</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> metrics</span><span class="token operator" style="color:#ff79c6">=</span><span class="token punctuation" style="color:#f8f8f2">[</span><span class="token string" style="color:#f1fa8c">&#x27;accuracy&#x27;</span><span class="token punctuation" style="color:#f8f8f2">]</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">model</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">fit</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">X_train</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> y_train</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> epochs</span><span class="token operator" style="color:#ff79c6">=</span><span class="token number" style="color:#50fa7b">100</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> batch_size</span><span class="token operator" style="color:#ff79c6">=</span><span class="token number" style="color:#50fa7b">20</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> shuffle</span><span class="token operator" style="color:#ff79c6">=</span><span class="token boolean" style="color:#bd93f9">False</span><span class="token punctuation" style="color:#f8f8f2">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>Above, you defined your model as sequential—meaning that any layer that you are
going to append later will be sequentially added to the previous one. Then, a
GRU layer was defined with seventy-five neurons, and a dense (fully connected)
layer was added that works as an output layer. Since you’re creating a deep
learning model, you also added an
<a href="https://towardsdatascience.com/optimizers-for-training-neural-network-59450d71caf6" target="_blank" rel="noopener noreferrer">optimizer</a>
and a
<a href="https://machinelearningmastery.com/loss-and-loss-functions-for-training-deep-learning-neural-networks/" target="_blank" rel="noopener noreferrer">loss function</a>.
In this case, <strong>“Adam”</strong> works well for GRU, and since you’re dealing with
numerical data, <strong>mean_squared_error</strong> will do the trick. Finally, the model was
fitted on the input data.</p><p>Once you execute the above code, your model training will start. It should look
something like this:</p><p><img alt="Model training" src="/assets/images/model-training-fff413d1d6cde987637a97f30774e9d7.png"></p><p>Once the model is ready, you’ll need to test it on the test set to check its
accuracy:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI python"><div tabindex="0" class="prism-code language-python codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#f8f8f2;background-color:#262833"><div class="token-line" style="color:#f8f8f2"><span class="token comment" style="color:#6272a4">## make predictions for test set</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">X_test </span><span class="token operator" style="color:#ff79c6">=</span><span class="token plain"> X_test</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">reshape</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token number" style="color:#50fa7b">500</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token number" style="color:#50fa7b">1</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token number" style="color:#50fa7b">1</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">y_pred </span><span class="token operator" style="color:#ff79c6">=</span><span class="token plain"> model</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">predict</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">X_test</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain"></span><span class="token comment" style="color:#6272a4">## visualise results</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">plt</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">plot</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">y_pred</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> label </span><span class="token operator" style="color:#ff79c6">=</span><span class="token plain"> </span><span class="token string" style="color:#f1fa8c">&#x27;predictions&#x27;</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">plt</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">plot</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">y_test</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> label </span><span class="token operator" style="color:#ff79c6">=</span><span class="token plain"> </span><span class="token string" style="color:#f1fa8c">&#x27;actual&#x27;</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">plt</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">legend</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token punctuation" style="color:#f8f8f2">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>The graphs displaying actual labels and predicted labels should look like this:</p><p><img alt="Model testing" src="/assets/images/model-testing-1-6e0e2992aacea1b9f8ccb948a0841620.png"></p><p>As you can see, the predictions are the approximation of actual values, which
indicates that the model is performing well enough. Since the testing data has a
lot of points, the graph appears clustered; to take a closer look at the values,
you can visualize just one hundred values as well:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI python"><div tabindex="0" class="prism-code language-python codeBlock_rtdJ thin-scrollbar"><div class="codeBlockLines_1zSZ" style="color:#f8f8f2;background-color:#262833"><div class="token-line" style="color:#f8f8f2"><span class="token comment" style="color:#6272a4">## visualize results</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">plt</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">plot</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">y_pred</span><span class="token punctuation" style="color:#f8f8f2">[</span><span class="token punctuation" style="color:#f8f8f2">:</span><span class="token number" style="color:#50fa7b">100</span><span class="token punctuation" style="color:#f8f8f2">]</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> label </span><span class="token operator" style="color:#ff79c6">=</span><span class="token plain"> </span><span class="token string" style="color:#f1fa8c">&#x27;predictions&#x27;</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">plt</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">plot</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token plain">y_test</span><span class="token punctuation" style="color:#f8f8f2">[</span><span class="token punctuation" style="color:#f8f8f2">:</span><span class="token number" style="color:#50fa7b">100</span><span class="token punctuation" style="color:#f8f8f2">]</span><span class="token punctuation" style="color:#f8f8f2">,</span><span class="token plain"> label </span><span class="token operator" style="color:#ff79c6">=</span><span class="token plain"> </span><span class="token string" style="color:#f1fa8c">&#x27;actual&#x27;</span><span class="token punctuation" style="color:#f8f8f2">)</span><span class="token plain"></span></div><div class="token-line" style="color:#f8f8f2"><span class="token plain">plt</span><span class="token punctuation" style="color:#f8f8f2">.</span><span class="token plain">legend</span><span class="token punctuation" style="color:#f8f8f2">(</span><span class="token punctuation" style="color:#f8f8f2">)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB">Copy</button></div></div><p>The simplified plot showing only one hundred actual and predicted values would
be something like this:</p><p><img alt="Model testing" src="/assets/images/model-testing-2-cc101302e86df256cf3648f25fa48858.png"></p><p>Now, your time series forecasting model is ready, and you can use it to make
predictions for upcoming dates. The code notebook for the full project can be
found
<a href="https://github.com/gouravsinghbais/Time-Series-Forecasting-with-Tensorflow-and-QuestDB" target="_blank" rel="noopener noreferrer">here</a>.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="conclusion"></a>Conclusion<a class="hash-link" href="#conclusion" title="Direct link to heading">#</a></h2><p>In this tutorial, you learned how to do time series forecasting using deep
learning framework, TensorFlow, and QuestDB. As more and more electronic and
mechanical devices are becoming smart nowadays, handling them manually is
ceasing to be an option. To efficiently automate the maintenance of these
machines, you need to have the right tools in place to store and process machine
generated data.</p><p>Traditional databases are not a good option for this, as they are more focused
on processing and writing data in transactions. Time series databases, on the
other hand, are specially designed for storing observations at different time
intervals. They also provide features and tools to help processing time series,
as you have seen in this tutorial.</p><p>If you like this content, we&#x27;d love to know your thoughts! Feel free to
<a href="https://github.com/questdb/questdb#try-questdb" target="_blank" rel="noopener noreferrer">get started on GitHub</a> and come
say hello <a href="https://" target="_blank" rel="noopener noreferrer">in our Slack Community</a>.</p></div><footer class="row margin-vert--lg"><div class="col"><strong>Tags:</strong><a class="margin-horiz--sm" href="/blog/tags/tutorial">tutorial</a><a class="margin-horiz--sm" href="/blog/tags/python">python</a><a class="margin-horiz--sm" href="/blog/tags/tensorflow">tensorflow</a><a class="margin-horiz--sm" href="/blog/tags/machine-learning">machine learning</a><a class="margin-horiz--sm" href="/blog/tags/data-science">data science</a></div></footer></article><div></div><div class="margin-vert--xl"><nav class="pagination-nav" aria-label="Blog post page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/blog/2022/08/05/setting-basic-auth-nginx"><div class="pagination-nav__sublabel">Newer Post</div><div class="pagination-nav__label">« Setting up Basic Authentication for QuestDB open source using Nginx</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/blog/2022/06/07/data-pipeline-with-kafka-and-questdb"><div class="pagination-nav__sublabel">Older Post</div><div class="pagination-nav__label">Building a Data Pipeline using QuestDB and Confluent Kafka »</div></a></div></nav></div></main></div></div><div class="root_0lLS"><div class="cards_xeZk"><div class="root_R798 skinPrimary_JHOH"><svg width="76" height="76" viewBox="0 0 76 76" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="38" cy="38" r="38" fill="#1E1F27"></circle><path d="M56.99 18.792a.817.817 0 00-.117-.303c-.01-.02-.02-.05-.03-.069-.01-.02-.029-.029-.048-.049a.912.912 0 00-.137-.136l-.117-.088c-.02-.01-.03-.03-.05-.04-.029-.01-.068-.029-.107-.039a.85.85 0 00-.146-.049 1.075 1.075 0 00-.176-.019h-.147a1.15 1.15 0 00-.196.049c-.029.01-.068.01-.097.02L12.59 36.67a.979.979 0 00-.509 1.29c.098.216.264.401.48.5l16.07 7.556v15.025c0 .537.44.977.978.977a.964.964 0 00.831-.469l6.794-11.046 10.499 5.533a.974.974 0 001.408-.655l7.84-36.2v-.058c.01-.058.01-.107.019-.156 0-.059 0-.117-.01-.176zM29.413 44.208L15.376 37.6l36.326-15.68-22.289 22.288zm1.174 13.363V47.004l4.917 2.59-4.917 7.977zm16.92-3.87l-9.237-4.86-1.662-1.026-.068.118-5.289-2.786 23.1-23.12L47.508 53.7z" fill="#fff"></path></svg><h3 class="title_BHe0">문의하기</h3><p class="description_Bwvi">이메일을 입력하시면 소개자료를 보내드립니다.</p><div class="content_gAr2"><form class="root_teCd"><div><div class="inputs_0wQ8"><input type="email" class="input_cjQx input_a6pP" name="email" required="" pattern="^[a-zA-Z0-9.!#$%&amp;&#x27;*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+$" placeholder="Email address" title="Email address should be valid"><button class="submit_poRs button_f7Ff button--tertiary_vtfp button--uppercase_ESEN" type="submit">보내기</button></div></div></form></div></div></div></div></div><footer class="root_JnvJ"><div class="content_-gfC center_S24y"><img alt="QuestDB logo" class="logo_JrwJ" src="/img/navbar/tp_brand.png" width="108" height="27"><div class="tagline_T1tH"><p>인프라관리부터 서비스운영까지 클라우드환경에 최적화된 클라우드 네이티브 플랫폼</p></div><div class="links_1SgP"><div class="category_Ptbh"><span class="title_HpoE">Product</span><ul class="items_Lw7J"><li><a class="link_vx7p" href="/cloud/">Cloud</a></li><li><a class="link_vx7p" href="/enterprise/">Enterprise</a></li><li><a class="link_vx7p" href="/pricing/">Pricing</a></li><li><a class="link_vx7p" href="/use-cases/">Use Cases</a></li><li><a class="link_vx7p" href="/customers/">Customers</a></li><li><a class="link_vx7p" href="https://github.com/orgs/questdb/projects/1/views/5" rel="noopener noreferrer" target="_blank">Roadmap</a></li></ul></div><div class="category_Ptbh"><span class="title_HpoE">Developers</span><ul class="items_Lw7J"><li><a class="link_vx7p" href="/docs/">Docs</a></li><li><a class="link_vx7p" href="/blog/tags/tutorial/">Tutorials</a></li><li><a class="link_vx7p" href="/blog/">Blog</a></li><li><a class="link_vx7p" href="https://">Discussions</a></li><li><a class="link_vx7p" href="https://">Join Slack</a></li><li><a class="link_vx7p" href="/community/">Swag</a></li></ul></div><div class="category_Ptbh"><span class="title_HpoE">Company</span><ul class="items_Lw7J"><li><a class="link_vx7p" href="/about-us/">About us</a></li><li><a class="link_vx7p" href="/careers/">Careers</a></li></ul></div></div></div><div class="border_PW0V"><div class="bottom_wPs3 center_S24y">Copyright © 2023 Gitple. All rights are reserved.</div></div></footer></div>
<script src="/assets/js/main.db1fdb94.js" defer="defer"></script>
</body>
</html>