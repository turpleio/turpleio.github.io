"use strict";(self.webpackChunkquestdb_io=self.webpackChunkquestdb_io||[]).push([[5339],{3905:function(e,t,n){n.d(t,{Zo:function(){return d},kt:function(){return m}});var o=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},a=Object.keys(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var s=o.createContext({}),c=function(e){var t=o.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},d=function(e){var t=c(e.components);return o.createElement(s.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},p=o.forwardRef((function(e,t){var n=e.components,r=e.mdxType,a=e.originalType,s=e.parentName,d=l(e,["components","mdxType","originalType","parentName"]),p=c(n),m=r,h=p["".concat(s,".").concat(m)]||p[m]||u[m]||a;return n?o.createElement(h,i(i({ref:t},d),{},{components:n})):o.createElement(h,i({ref:t},d))}));function m(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var a=n.length,i=new Array(a);i[0]=p;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:r,i[1]=l;for(var c=2;c<a;c++)i[c]=n[c];return o.createElement.apply(null,i)}return o.createElement.apply(null,n)}p.displayName="MDXCreateElement"},3268:function(e,t,n){n.r(t),n.d(t,{frontMatter:function(){return l},metadata:function(){return s},toc:function(){return c},default:function(){return u}});var o=n(3117),r=n(102),a=(n(7294),n(3905)),i=["components"],l={title:"FAQ",description:"FAQ for QuestDB troubleshooting."},s={unversionedId:"troubleshooting/faq",id:"troubleshooting/faq",isDocsHomePage:!1,title:"FAQ",description:"FAQ for QuestDB troubleshooting.",source:"@site/docs/troubleshooting/faq.md",sourceDirName:"troubleshooting",slug:"/troubleshooting/faq",permalink:"/docs/troubleshooting/faq",editUrl:"https://github.com/turpleio/homepage/edit/main/docs/troubleshooting/faq.md",version:"current",frontMatter:{title:"FAQ",description:"FAQ for QuestDB troubleshooting."},sidebar:"docs",previous:{title:"WITH keyword",permalink:"/docs/reference/sql/with"},next:{title:"List of OS error codes",permalink:"/docs/troubleshooting/os-error-codes"}},c=[{value:"How do I delete a row?",id:"how-do-i-delete-a-row",children:[]},{value:"How do I convert a <code>STRING</code> column to a <code>SYMBOL</code> or vice versa?",id:"how-do-i-convert-a-string-column-to-a-symbol-or-vice-versa",children:[]},{value:"Why do I get <code>table busy</code> error messages when inserting data over PostgreSQL wire protocol?",id:"why-do-i-get-table-busy-error-messages-when-inserting-data-over-postgresql-wire-protocol",children:[]},{value:"Why do I see <code>could not open read-write</code> messages when creating a table or inserting rows?",id:"why-do-i-see-could-not-open-read-write-messages-when-creating-a-table-or-inserting-rows",children:[]},{value:"Why do I see <code>errno=12</code> mmap messages in the server logs?",id:"why-do-i-see-errno12-mmap-messages-in-the-server-logs",children:[]},{value:"How do I avoid duplicate rows with identical fields?",id:"how-do-i-avoid-duplicate-rows-with-identical-fields",children:[]}],d={toc:c};function u(e){var t=e.components,n=(0,r.Z)(e,i);return(0,a.kt)("wrapper",(0,o.Z)({},d,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("p",null,"The following document contains common hardware and software configuration\nissues met when running QuestDB, as well as solutions to them."),(0,a.kt)("h2",{id:"how-do-i-delete-a-row"},"How do I delete a row?"),(0,a.kt)("p",null,"See our guide on ",(0,a.kt)("a",{parentName:"p",href:"/docs/guides/modifying-data"},"modifying data"),"."),(0,a.kt)("h2",{id:"how-do-i-convert-a-string-column-to-a-symbol-or-vice-versa"},"How do I convert a ",(0,a.kt)("inlineCode",{parentName:"h2"},"STRING")," column to a ",(0,a.kt)("inlineCode",{parentName:"h2"},"SYMBOL")," or vice versa?"),(0,a.kt)("p",null,"The SQL ",(0,a.kt)("inlineCode",{parentName:"p"},"UPDATE")," keyword can be used to change the data type of a column. The\nsame approach can also be used to increase the\n",(0,a.kt)("a",{parentName:"p",href:"/docs/concept/symbol#symbol-columns"},"capacity of a ",(0,a.kt)("inlineCode",{parentName:"a"},"SYMBOL")," column")," that is\nundersized."),(0,a.kt)("p",null,"The steps are as follows:"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"Add a new column to the table and define the desired data type."),(0,a.kt)("li",{parentName:"ol"},"Stop data ingestion and increase\n",(0,a.kt)("a",{parentName:"li",href:"/docs/reference/configuration/#cairo-engine/"},"SQL query timeout"),",\n",(0,a.kt)("inlineCode",{parentName:"li"},"query.timeout.sec"),", as ",(0,a.kt)("inlineCode",{parentName:"li"},"UPDATE")," may take a while to complete. Depending on\nthe size of the column, we recommend to increase the value significantly: the\ndefault is 60 seconds and it may be reasonable to increase it to one hour.\nRestart the instance after changing the configuration, to activate the\nchange."),(0,a.kt)("li",{parentName:"ol"},"Use ",(0,a.kt)("inlineCode",{parentName:"li"},"UPDATE")," to copy the existing column content to the new column. Now, the\ncolumn has the correct content with the new data type."),(0,a.kt)("li",{parentName:"ol"},"Delete the old column."),(0,a.kt)("li",{parentName:"ol"},"Rename the new column accordingly. For example, to change ",(0,a.kt)("inlineCode",{parentName:"li"},"old_col")," from\n",(0,a.kt)("inlineCode",{parentName:"li"},"STRING")," to ",(0,a.kt)("inlineCode",{parentName:"li"},"SYMBOL")," for table ",(0,a.kt)("inlineCode",{parentName:"li"},"my_table"),":")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-questdb-sql"},"ALTER TABLE my_table ADD COLUMN new_col SYMBOL;\nUPDATE my_table SET new_col = old_col;\nALTER TABLE my_table DROP COLUMN old_col;\nALTER TABLE my_table RENAME COLUMN new_col TO old_col;\n")),(0,a.kt)("h2",{id:"why-do-i-get-table-busy-error-messages-when-inserting-data-over-postgresql-wire-protocol"},"Why do I get ",(0,a.kt)("inlineCode",{parentName:"h2"},"table busy")," error messages when inserting data over PostgreSQL wire protocol?"),(0,a.kt)("p",null,"You may get ",(0,a.kt)("inlineCode",{parentName:"p"},"table busy [reason=insert]")," or similar errors when running ",(0,a.kt)("inlineCode",{parentName:"p"},"INSERT"),"\nstatements concurrently on the same table. This means that the table is locked\nby inserts issued from another SQL connection or other client protocols for data\nimport, like ILP over TCP or CSV over HTTP. To reduce the chances of getting\nthis error, try using auto-commit to keep the transaction as short as possible."),(0,a.kt)("p",null,"We're also considering adding automatic insert retries on the database side, but\nfor now, it is safe to handle this error on the client side and retry the\ninsert."),(0,a.kt)("h2",{id:"why-do-i-see-could-not-open-read-write-messages-when-creating-a-table-or-inserting-rows"},"Why do I see ",(0,a.kt)("inlineCode",{parentName:"h2"},"could not open read-write")," messages when creating a table or inserting rows?"),(0,a.kt)("p",null,"Log messages may appear like the following:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"2022-02-01T13:40:11.336011Z I i.q.c.l.t.LineTcpMeasurementScheduler could not create table [tableName=cpu, ex=could not open read-write\n...\nio.questdb.cairo.CairoException: [24] could not open read-only [file=/root/.questdb/db/cpu/service.k]\n")),(0,a.kt)("p",null,"The machine may have insufficient limits for the maximum number of open files.\nTry checking the ",(0,a.kt)("inlineCode",{parentName:"p"},"ulimit")," value on your machine. Refer to\n",(0,a.kt)("a",{parentName:"p",href:"/docs/operations/capacity-planning#maximum-open-files"},"capacity planning")," page\nfor more details."),(0,a.kt)("h2",{id:"why-do-i-see-errno12-mmap-messages-in-the-server-logs"},"Why do I see ",(0,a.kt)("inlineCode",{parentName:"h2"},"errno=12")," mmap messages in the server logs?"),(0,a.kt)("p",null,"Log messages may appear like the following:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"2022-02-01T13:40:10.636014Z E i.q.c.l.t.LineTcpConnectionContext [8655] could not process line data [table=test_table, msg=could not mmap  [size=248, offset=0, fd=1766, memUsed=314809894008, fileLen=8192], errno=12]\n")),(0,a.kt)("p",null,"The machine may have insufficient limits of memory map areas a process may have.\nTry checking and increasing the ",(0,a.kt)("inlineCode",{parentName:"p"},"vm.max_map_count")," value on your machine. Refer\nto\n",(0,a.kt)("a",{parentName:"p",href:"/docs/operations/capacity-planning#max-virtual-memory-areas-limit"},"capacity planning"),"\npage for more details."),(0,a.kt)("h2",{id:"how-do-i-avoid-duplicate-rows-with-identical-fields"},"How do I avoid duplicate rows with identical fields?"),(0,a.kt)("p",null,"We have an open\n",(0,a.kt)("a",{parentName:"p",href:"https://github.com/questdb/roadmap/issues/3"},"feature request to optionally de-duplicate rows"),"\ninserted with identical fields. Until then, you need to\n",(0,a.kt)("a",{parentName:"p",href:"/docs/guides/modifying-data"},"modify the data")," after it's inserted and use a\n",(0,a.kt)("inlineCode",{parentName:"p"},"GROUP BY")," query to identify duplicates."))}u.isMDXComponent=!0}}]);