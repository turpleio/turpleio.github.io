"use strict";(self.webpackChunkquestdb_io=self.webpackChunkquestdb_io||[]).push([[1851],{3905:function(t,e,a){a.d(e,{Zo:function(){return g},kt:function(){return I}});var n=a(67294);function l(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}function r(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,n)}return a}function i(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?r(Object(a),!0).forEach((function(e){l(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}function p(t,e){if(null==t)return{};var a,n,l=function(t,e){if(null==t)return{};var a,n,l={},r=Object.keys(t);for(n=0;n<r.length;n++)a=r[n],e.indexOf(a)>=0||(l[a]=t[a]);return l}(t,e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);for(n=0;n<r.length;n++)a=r[n],e.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(t,a)&&(l[a]=t[a])}return l}var m=n.createContext({}),d=function(t){var e=n.useContext(m),a=e;return t&&(a="function"==typeof t?t(e):i(i({},e),t)),a},g=function(t){var e=d(t.components);return n.createElement(m.Provider,{value:e},t.children)},o={inlineCode:"code",wrapper:function(t){var e=t.children;return n.createElement(n.Fragment,{},e)}},u=n.forwardRef((function(t,e){var a=t.components,l=t.mdxType,r=t.originalType,m=t.parentName,g=p(t,["components","mdxType","originalType","parentName"]),u=d(a),I=l,s=u["".concat(m,".").concat(I)]||u[I]||o[I]||r;return a?n.createElement(s,i(i({ref:e},g),{},{components:a})):n.createElement(s,i({ref:e},g))}));function I(t,e){var a=arguments,l=e&&e.mdxType;if("string"==typeof t||l){var r=a.length,i=new Array(r);i[0]=u;var p={};for(var m in e)hasOwnProperty.call(e,m)&&(p[m]=e[m]);p.originalType=t,p.mdxType="string"==typeof t?t:l,i[1]=p;for(var d=2;d<r;d++)i[d]=a[d];return n.createElement.apply(null,i)}return n.createElement.apply(null,a)}u.displayName="MDXCreateElement"},45461:function(t,e,a){a.r(e),a.d(e,{frontMatter:function(){return p},metadata:function(){return m},toc:function(){return d},default:function(){return o}});var n=a(83117),l=a(80102),r=(a(67294),a(3905)),i=["components"],p={title:"SAMPLE BY keyword",sidebar_label:"SAMPLE BY",description:"SAMPLE BY SQL keyword reference documentation."},m={unversionedId:"reference/sql/sample-by",id:"reference/sql/sample-by",isDocsHomePage:!1,title:"SAMPLE BY keyword",description:"SAMPLE BY SQL keyword reference documentation.",source:"@site/docs/reference/sql/sample-by.md",sourceDirName:"reference/sql",slug:"/reference/sql/sample-by",permalink:"/docs/reference/sql/sample-by",editUrl:"https://github.com/turpleio/homepage/edit/main/docs/reference/sql/sample-by.md",version:"current",sidebar_label:"SAMPLE BY",frontMatter:{title:"SAMPLE BY keyword",sidebar_label:"SAMPLE BY",description:"SAMPLE BY SQL keyword reference documentation."},sidebar:"docs",previous:{title:"RENAME TABLE keyword",permalink:"/docs/reference/sql/rename"},next:{title:"SELECT keyword",permalink:"/docs/reference/sql/select"}},d=[{value:"Syntax",id:"syntax",children:[]},{value:"Sample units",id:"sample-units",children:[]},{value:"Fill options",id:"fill-options",children:[{value:"Multiple fill values",id:"multiple-fill-values",children:[]}]},{value:"Sample calculation",id:"sample-calculation",children:[]},{value:"ALIGN TO CALENDAR",id:"align-to-calendar",children:[{value:"TIME ZONE",id:"time-zone",children:[]},{value:"WITH OFFSET",id:"with-offset",children:[]}]},{value:"Examples",id:"examples",children:[]},{value:"See also",id:"see-also",children:[]}],g={toc:d};function o(t){var e=t.components,p=(0,l.Z)(t,i);return(0,r.kt)("wrapper",(0,n.Z)({},g,p,{components:e,mdxType:"MDXLayout"}),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"SAMPLE BY")," is used on time series data to summarize large datasets into\naggregates of homogeneous time chunks as part of a\n",(0,r.kt)("a",{parentName:"p",href:"/docs/reference/sql/select"},"SELECT statement"),". Users performing ",(0,r.kt)("inlineCode",{parentName:"p"},"SAMPLE BY"),"\nqueries on datasets ",(0,r.kt)("strong",{parentName:"p"},"with missing data")," may make use of the\n",(0,r.kt)("a",{parentName:"p",href:"#fill-options"},"FILL")," keyword to specify a fill behavior."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",30:!0,className:"language-questdb-sql",metastring:'title="Sample trades table in 30 minute intervals"',title:'"Sample',trades:!0,table:!0,in:!0,minute:!0,'intervals"':!0},"SELECT time, avg(price) FROM trades SAMPLE BY 30m\n")),(0,r.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"info")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"To use ",(0,r.kt)("inlineCode",{parentName:"p"},"SAMPLE BY"),", a table column needs to be specified as a designated\ntimestamp. Details about this concept can be found in the\n",(0,r.kt)("a",{parentName:"p",href:"/docs/concept/designated-timestamp"},"designated timestamp")," documentation."))),(0,r.kt)("h2",{id:"syntax"},"Syntax"),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Flow chart showing the syntax of the SAMPLE BY keywords",src:a(44580).Z}),"\n",(0,r.kt)("img",{alt:"Flow chart showing the syntax of the ALIGN TO keywords",src:a(50532).Z}),"\n",(0,r.kt)("img",{alt:"Flow chart showing the syntax of the FILL keyword",src:a(97433).Z})),(0,r.kt)("h2",{id:"sample-units"},"Sample units"),(0,r.kt)("p",null,"The size of sampled groups are specified with the following syntax:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-questdb-sql"},"SAMPLE BY n{units}\n")),(0,r.kt)("p",null,"Where the unit for sampled groups may be one of the following:"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"unit"),(0,r.kt)("th",{parentName:"tr",align:null},"description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"U")),(0,r.kt)("td",{parentName:"tr",align:null},"microsecond")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"T")),(0,r.kt)("td",{parentName:"tr",align:null},"millisecond")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"s")),(0,r.kt)("td",{parentName:"tr",align:null},"second")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"m")),(0,r.kt)("td",{parentName:"tr",align:null},"minute")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"h")),(0,r.kt)("td",{parentName:"tr",align:null},"hour")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"d")),(0,r.kt)("td",{parentName:"tr",align:null},"day")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"M")),(0,r.kt)("td",{parentName:"tr",align:null},"month")))),(0,r.kt)("p",null,"For example, given a table ",(0,r.kt)("inlineCode",{parentName:"p"},"trades"),", the following query returns the number of\ntrades per hour:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-questdb-sql"},"SELECT ts, count() FROM trades SAMPLE BY 1h\n")),(0,r.kt)("h2",{id:"fill-options"},"Fill options"),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"FILL")," keyword is optional and expects one or more ",(0,r.kt)("inlineCode",{parentName:"p"},"fillOption")," strategies\nwhich will be applied to one or more aggregate columns. The following\nrestrictions apply:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Keywords denoting fill strategies may not be combined. Only one option from\n",(0,r.kt)("inlineCode",{parentName:"li"},"NONE"),", ",(0,r.kt)("inlineCode",{parentName:"li"},"NULL"),", ",(0,r.kt)("inlineCode",{parentName:"li"},"PREV"),", ",(0,r.kt)("inlineCode",{parentName:"li"},"LINEAR")," and constants may be used."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"LINEAR")," strategy is not supported for keyed queries, i.e. queries that\ncontain non-aggregated columns other than the timestamp in the SELECT clause.")),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"fillOption"),(0,r.kt)("th",{parentName:"tr",align:null},"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"NONE")),(0,r.kt)("td",{parentName:"tr",align:null},"No fill applied. If there is no data, the time sample will be skipped in the results. A table could be missing intervals.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"NULL")),(0,r.kt)("td",{parentName:"tr",align:null},"Fills with ",(0,r.kt)("inlineCode",{parentName:"td"},"NULL")," values.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"PREV")),(0,r.kt)("td",{parentName:"tr",align:null},"Fills using the previous value.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"LINEAR")),(0,r.kt)("td",{parentName:"tr",align:null},"Fills by linear interpolation of the 2 surrounding points.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"x")),(0,r.kt)("td",{parentName:"tr",align:null},"Fills with a constant value - where ",(0,r.kt)("inlineCode",{parentName:"td"},"x")," is the desired value, for example ",(0,r.kt)("inlineCode",{parentName:"td"},"FILL(100.05)"),".")))),(0,r.kt)("p",null,"Consider an example table named ",(0,r.kt)("inlineCode",{parentName:"p"},"prices")," which has no records during the entire\nthird hour (",(0,r.kt)("inlineCode",{parentName:"p"},"2021-01-01T03"),"):"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"ts"),(0,r.kt)("th",{parentName:"tr",align:null},"price"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"2021-01-01T01:00:00.000000Z"),(0,r.kt)("td",{parentName:"tr",align:null},"p1")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"2021-01-01T02:00:00.000000Z"),(0,r.kt)("td",{parentName:"tr",align:null},"p2")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"2021-01-01T04:00:00.000000Z"),(0,r.kt)("td",{parentName:"tr",align:null},"p4")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"2021-01-01T05:00:00.000000Z"),(0,r.kt)("td",{parentName:"tr",align:null},"p5")))),(0,r.kt)("p",null,"The following query returns the maximum price per hour. As there are missing\nvalues, an aggregate cannot be calculated:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-questdb-sql"},"SELECT ts, max(price) max FROM prices SAMPLE BY 1h;\n")),(0,r.kt)("p",null,"A row is missing for the ",(0,r.kt)("inlineCode",{parentName:"p"},"2021-01-01T03:00:00.000000Z")," sample:"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"ts"),(0,r.kt)("th",{parentName:"tr",align:null},"max"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"2021-01-01T01:00:00.000000Z"),(0,r.kt)("td",{parentName:"tr",align:null},"max1")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"2021-01-01T02:00:00.000000Z"),(0,r.kt)("td",{parentName:"tr",align:null},"max2")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"2021-01-01T04:00:00.000000Z"),(0,r.kt)("td",{parentName:"tr",align:null},"max4")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"2021-01-01T05:00:00.000000Z"),(0,r.kt)("td",{parentName:"tr",align:null},"max5")))),(0,r.kt)("p",null,"A ",(0,r.kt)("inlineCode",{parentName:"p"},"FILL")," strategy can be employed which fills with the previous value using\n",(0,r.kt)("inlineCode",{parentName:"p"},"PREV"),":"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-questdb-sql"},"SELECT ts, max(price) max FROM prices SAMPLE BY 1h FILL(PREV);\n")),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"ts"),(0,r.kt)("th",{parentName:"tr",align:null},"max"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"2021-01-01T01:00:00.000000Z"),(0,r.kt)("td",{parentName:"tr",align:null},"max1")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"2021-01-01T02:00:00.000000Z"),(0,r.kt)("td",{parentName:"tr",align:null},"max2")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("strong",{parentName:"td"},"2021-01-01T03:00:00.000000Z")),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("strong",{parentName:"td"},"max2"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"2021-01-01T04:00:00.000000Z"),(0,r.kt)("td",{parentName:"tr",align:null},"max4")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"2021-01-01T05:00:00.000000Z"),(0,r.kt)("td",{parentName:"tr",align:null},"max5")))),(0,r.kt)("p",null,"Linear interpolation is done using the ",(0,r.kt)("inlineCode",{parentName:"p"},"LINEAR")," fill option:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-questdb-sql"},"SELECT ts, max(price) max FROM prices SAMPLE BY 1h FILL(LINEAR);\n")),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"ts"),(0,r.kt)("th",{parentName:"tr",align:null},"max"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"2021-01-01T01:00:00.000000Z"),(0,r.kt)("td",{parentName:"tr",align:null},"max1")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"2021-01-01T02:00:00.000000Z"),(0,r.kt)("td",{parentName:"tr",align:null},"max2")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("strong",{parentName:"td"},"2021-01-01T03:00:00.000000Z")),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("strong",{parentName:"td"},"(max2+max4)/2"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"2021-01-01T04:00:00.000000Z"),(0,r.kt)("td",{parentName:"tr",align:null},"max4")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"2021-01-01T05:00:00.000000Z"),(0,r.kt)("td",{parentName:"tr",align:null},"max5")))),(0,r.kt)("p",null,"A constant value can be used as a ",(0,r.kt)("inlineCode",{parentName:"p"},"fillOption"),":"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-questdb-sql"},"SELECT ts, max(price) max FROM prices SAMPLE BY 1h FILL(100.5);\n")),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"ts"),(0,r.kt)("th",{parentName:"tr",align:null},"max"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"2021-01-01T01:00:00.000000Z"),(0,r.kt)("td",{parentName:"tr",align:null},"max1")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"2021-01-01T02:00:00.000000Z"),(0,r.kt)("td",{parentName:"tr",align:null},"max2")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("strong",{parentName:"td"},"2021-01-01T03:00:00.000000Z")),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("strong",{parentName:"td"},"100.5"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"2021-01-01T04:00:00.000000Z"),(0,r.kt)("td",{parentName:"tr",align:null},"max4")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"2021-01-01T05:00:00.000000Z"),(0,r.kt)("td",{parentName:"tr",align:null},"max5")))),(0,r.kt)("p",null,"Finally, ",(0,r.kt)("inlineCode",{parentName:"p"},"NULL")," may be used as a ",(0,r.kt)("inlineCode",{parentName:"p"},"fillOption"),":"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-questdb-sql"},"SELECT ts, max(price) max FROM prices SAMPLE BY 1h FILL(NULL);\n")),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"ts"),(0,r.kt)("th",{parentName:"tr",align:null},"max"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"2021-01-01T01:00:00.000000Z"),(0,r.kt)("td",{parentName:"tr",align:null},"max1")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"2021-01-01T02:00:00.000000Z"),(0,r.kt)("td",{parentName:"tr",align:null},"max2")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("strong",{parentName:"td"},"2021-01-01T03:00:00.000000Z")),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("strong",{parentName:"td"},"null"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"2021-01-01T04:00:00.000000Z"),(0,r.kt)("td",{parentName:"tr",align:null},"max4")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"2021-01-01T05:00:00.000000Z"),(0,r.kt)("td",{parentName:"tr",align:null},"max5")))),(0,r.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"info")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"The ",(0,r.kt)("inlineCode",{parentName:"p"},"FILL")," keyword must precede alignment described in the\n",(0,r.kt)("a",{parentName:"p",href:"#sample-calculation"},"sample calculation section"),", i.e.:"),(0,r.kt)("pre",{parentName:"div"},(0,r.kt)("code",{parentName:"pre",className:"language-questdb-sql"},"SELECT ts, max(price) max FROM prices\nSAMPLE BY 1h FILL(LINEAR)\nALIGN TO ...\n")))),(0,r.kt)("h3",{id:"multiple-fill-values"},"Multiple fill values"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"FILL()")," accepts a list of values where each value corresponds to a single\naggregate column in the SELECT clause order:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-questdb-sql"},"SELECT min(price), max(price), avg(price), ts\nFROM prices\nSAMPLE BY 1h\nFILL(NULL, 10, PREV);\n")),(0,r.kt)("p",null,"In the above query ",(0,r.kt)("inlineCode",{parentName:"p"},"min(price)")," aggregate will get ",(0,r.kt)("inlineCode",{parentName:"p"},"FILL(NULL)")," strategy\napplied, ",(0,r.kt)("inlineCode",{parentName:"p"},"max(price)")," will get ",(0,r.kt)("inlineCode",{parentName:"p"},"FILL(10)"),", and ",(0,r.kt)("inlineCode",{parentName:"p"},"avg(price)")," will get\n",(0,r.kt)("inlineCode",{parentName:"p"},"FILL(PREV)"),"."),(0,r.kt)("h2",{id:"sample-calculation"},"Sample calculation"),(0,r.kt)("p",null,"The default time calculation of sampled groups is an absolute value, in other\nwords, sampling by one day is a 24 hour range which is not bound to calendar\ndates. To align sampled groups to calendar dates, the ",(0,r.kt)("inlineCode",{parentName:"p"},"ALIGN TO")," keywords can be\nused and are described in the ",(0,r.kt)("a",{parentName:"p",href:"#align-to-calendar"},"ALIGN TO CALENDAR")," section\nbelow."),(0,r.kt)("p",null,"Consider a table ",(0,r.kt)("inlineCode",{parentName:"p"},"sensors")," with the following data spanning three calendar days:"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"ts"),(0,r.kt)("th",{parentName:"tr",align:null},"val"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"2021-05-31T23:10:00.000000Z"),(0,r.kt)("td",{parentName:"tr",align:null},"10")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"2021-06-01T01:10:00.000000Z"),(0,r.kt)("td",{parentName:"tr",align:null},"80")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"2021-06-01T07:20:00.000000Z"),(0,r.kt)("td",{parentName:"tr",align:null},"15")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"2021-06-01T13:20:00.000000Z"),(0,r.kt)("td",{parentName:"tr",align:null},"10")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"2021-06-01T19:20:00.000000Z"),(0,r.kt)("td",{parentName:"tr",align:null},"40")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"2021-06-02T01:10:00.000000Z"),(0,r.kt)("td",{parentName:"tr",align:null},"90")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"2021-06-02T07:20:00.000000Z"),(0,r.kt)("td",{parentName:"tr",align:null},"30")))),(0,r.kt)("p",null,"The following query can be used to sample the table by day. Note that the\ndefault sample calculation can be made explicit in a query using\n",(0,r.kt)("inlineCode",{parentName:"p"},"ALIGN TO FIRST OBSERVATION"),":"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-questdb-sql"},"SELECT ts, count() FROM sensors\nSAMPLE BY 1d\n\n-- Equivalent to\nSELECT ts, count() FROM sensors\nSAMPLE BY 1d\nALIGN TO FIRST OBSERVATION\n")),(0,r.kt)("p",null,"This query will return two rows:"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"ts"),(0,r.kt)("th",{parentName:"tr",align:null},"count"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"2021-05-31T23:10:00.000000Z"),(0,r.kt)("td",{parentName:"tr",align:null},"5")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"2021-06-01T23:10:00.000000Z"),(0,r.kt)("td",{parentName:"tr",align:null},"2")))),(0,r.kt)("p",null,"The timestamp value for the 24 hour groups start at the first-observed\ntimestamp."),(0,r.kt)("h2",{id:"align-to-calendar"},"ALIGN TO CALENDAR"),(0,r.kt)("p",null,"The option aligns data to calendar dates, with two optional parameters:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"#time-zone"},"TIME ZONE")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"#with-offset"},"WITH OFFSET"))),(0,r.kt)("h3",{id:"time-zone"},"TIME ZONE"),(0,r.kt)("p",null,"A time zone may be provided for sampling with calendar alignment. Details on the\noptions for specifying time zones with available formats are provided in the\nguide for\n",(0,r.kt)("a",{parentName:"p",href:"/docs/guides/working-with-timestamps-timezones"},"working with timestamps and time zones"),"."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-questdb-sql"},"SELECT ts, count() FROM sensors\nSAMPLE BY 1d\nALIGN TO CALENDAR TIME ZONE 'Europe/Berlin'\n")),(0,r.kt)("p",null,"In this case, the 24 hour samples begin at ",(0,r.kt)("inlineCode",{parentName:"p"},"2021-05-31T01:00:00.000000Z"),":"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"ts"),(0,r.kt)("th",{parentName:"tr",align:null},"count"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"2021-05-31T01:00:00.000000Z"),(0,r.kt)("td",{parentName:"tr",align:null},"1")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"2021-06-01T01:00:00.000000Z"),(0,r.kt)("td",{parentName:"tr",align:null},"4")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"2021-06-02T01:00:00.000000Z"),(0,r.kt)("td",{parentName:"tr",align:null},"2")))),(0,r.kt)("p",null,"Additionally, an offset may be applied when aligning sample calculation to\ncalendar"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-questdb-sql"},"SELECT ts, count() FROM sensors\nSAMPLE BY 1d\nALIGN TO CALENDAR TIME ZONE 'Europe/Berlin' WITH OFFSET '00:45'\n")),(0,r.kt)("p",null,"In this case, the 24 hour samples begin at ",(0,r.kt)("inlineCode",{parentName:"p"},"2021-05-31T01:45:00.000000Z"),":"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"ts"),(0,r.kt)("th",{parentName:"tr",align:null},"count"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"2021-05-31T01:45:00.000000Z"),(0,r.kt)("td",{parentName:"tr",align:null},"2")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"2021-06-01T01:45:00.000000Z"),(0,r.kt)("td",{parentName:"tr",align:null},"4")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"2021-06-02T01:45:00.000000Z"),(0,r.kt)("td",{parentName:"tr",align:null},"1")))),(0,r.kt)("h4",{id:"local-timezone-output"},"Local timezone output"),(0,r.kt)("p",null,"The timestamp values output from ",(0,r.kt)("inlineCode",{parentName:"p"},"SAMPLE BY")," queries is in UTC. To have UTC\nvalues converted to specific timezones the\n",(0,r.kt)("a",{parentName:"p",href:"/docs/reference/function/date-time#to_timezone"},"to_timezone() function")," should\nbe used."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-questdb-sql"},"SELECT to_timezone(ts, 'PST') ts, count\nFROM (SELECT ts, count()\n      FROM sensors SAMPLE BY 2h\n      ALIGN TO CALENDAR TIME ZONE 'PST')\n")),(0,r.kt)("h4",{id:"time-zone-transitions"},"Time zone transitions"),(0,r.kt)("p",null,"Calendar dates may contain historical time zone transitions or may vary in the\ntotal number of hours due to daylight savings time. Considering the 31st October\n2021, in the ",(0,r.kt)("inlineCode",{parentName:"p"},"Europe/London")," calendar day which consists of 25 hours:"),(0,r.kt)("blockquote",null,(0,r.kt)("ul",{parentName:"blockquote"},(0,r.kt)("li",{parentName:"ul"},"Sunday, 31 October 2021, 02:00:00 clocks are turned backward 1 hour to"),(0,r.kt)("li",{parentName:"ul"},"Sunday, 31 October 2021, 01:00:00 local standard time"))),(0,r.kt)("p",null,"When a ",(0,r.kt)("inlineCode",{parentName:"p"},"SAMPLE BY")," operation crosses time zone transitions in cases such as\nthis, the first sampled group which spans a transition will include aggregates\nby full calendar range. Consider a table ",(0,r.kt)("inlineCode",{parentName:"p"},"sensors")," with one data point per hour\nspanning three calendar hours:"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"ts"),(0,r.kt)("th",{parentName:"tr",align:null},"val"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"2021-10-31T00:10:00.000000Z"),(0,r.kt)("td",{parentName:"tr",align:null},"10")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"2021-10-31T01:10:00.000000Z"),(0,r.kt)("td",{parentName:"tr",align:null},"20")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"2021-10-31T02:10:00.000000Z"),(0,r.kt)("td",{parentName:"tr",align:null},"30")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"2021-10-31T03:10:00.000000Z"),(0,r.kt)("td",{parentName:"tr",align:null},"40")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"2021-10-31T04:10:00.000000Z"),(0,r.kt)("td",{parentName:"tr",align:null},"50")))),(0,r.kt)("p",null,"The following query will sample by hour with the ",(0,r.kt)("inlineCode",{parentName:"p"},"Europe/London")," time zone and\nalign to calendar ranges:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-questdb-sql"},"SELECT ts, count() FROM sensors\nSAMPLE BY 1h\nALIGN TO CALENDAR TIME ZONE 'Europe/London'\n")),(0,r.kt)("p",null,"The record count for the hour which encounters a time zone transition will\ncontain two records for both hours at the time zone transition:"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"ts"),(0,r.kt)("th",{parentName:"tr",align:null},"count"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"2021-10-31T00:00:00.000000Z"),(0,r.kt)("td",{parentName:"tr",align:null},"2")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"2021-10-31T01:00:00.000000Z"),(0,r.kt)("td",{parentName:"tr",align:null},"1")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"2021-10-31T02:00:00.000000Z"),(0,r.kt)("td",{parentName:"tr",align:null},"1")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"2021-10-31T03:00:00.000000Z"),(0,r.kt)("td",{parentName:"tr",align:null},"1")))),(0,r.kt)("p",null,"Similarly, given one data point per hour on this table, running ",(0,r.kt)("inlineCode",{parentName:"p"},"SAMPLE BY 1d"),"\nwill have a count of ",(0,r.kt)("inlineCode",{parentName:"p"},"25")," for this day when aligned to calendar time zone\n'Europe/London'."),(0,r.kt)("h3",{id:"with-offset"},"WITH OFFSET"),(0,r.kt)("p",null,"Aligning sampling calculation can be provided an arbitrary offset in the format\n",(0,r.kt)("inlineCode",{parentName:"p"},"'+/-HH:mm'"),", for example:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"'00:30'")," plus thirty minutes"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"'+00:30'")," plus thirty minutes"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"'-00:15'")," minus 15 minutes")),(0,r.kt)("p",null,"The query uses the default offset '00:00' if the parameter is not set."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-questdb-sql"},"SELECT ts, count() FROM sensors\nSAMPLE BY 1d\nALIGN TO CALENDAR WITH OFFSET '02:00'\n")),(0,r.kt)("p",null,"In this case, the 24 hour samples begin at ",(0,r.kt)("inlineCode",{parentName:"p"},"2021-05-31T02:00:00.000000Z"),":"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"ts"),(0,r.kt)("th",{parentName:"tr",align:null},"count"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"2021-05-31T02:00:00.000000Z"),(0,r.kt)("td",{parentName:"tr",align:null},"2")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"2021-06-01T02:00:00.000000Z"),(0,r.kt)("td",{parentName:"tr",align:null},"4")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"2021-06-02T02:00:00.000000Z"),(0,r.kt)("td",{parentName:"tr",align:null},"1")))),(0,r.kt)("h2",{id:"examples"},"Examples"),(0,r.kt)("p",null,"Assume the following table ",(0,r.kt)("inlineCode",{parentName:"p"},"trades"),":"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"ts"),(0,r.kt)("th",{parentName:"tr",align:null},"quantity"),(0,r.kt)("th",{parentName:"tr",align:null},"price"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"2021-05-31T23:45:10.000000Z"),(0,r.kt)("td",{parentName:"tr",align:null},"10"),(0,r.kt)("td",{parentName:"tr",align:null},"100.05")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"2021-06-01T00:01:33.000000Z"),(0,r.kt)("td",{parentName:"tr",align:null},"5"),(0,r.kt)("td",{parentName:"tr",align:null},"100.05")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"2021-06-01T00:15:14.000000Z"),(0,r.kt)("td",{parentName:"tr",align:null},"200"),(0,r.kt)("td",{parentName:"tr",align:null},"100.15")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"2021-06-01T00:30:40.000000Z"),(0,r.kt)("td",{parentName:"tr",align:null},"300"),(0,r.kt)("td",{parentName:"tr",align:null},"100.15")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"2021-06-01T00:45:20.000000Z"),(0,r.kt)("td",{parentName:"tr",align:null},"10"),(0,r.kt)("td",{parentName:"tr",align:null},"100")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"2021-06-01T01:00:50.000000Z"),(0,r.kt)("td",{parentName:"tr",align:null},"50"),(0,r.kt)("td",{parentName:"tr",align:null},"100.15")))),(0,r.kt)("p",null,"This query will return the number of trades per hour:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-questdb-sql",metastring:'title="Hourly interval"',title:'"Hourly','interval"':!0},"SELECT ts, count() FROM trades SAMPLE BY 1h;\n")),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"ts"),(0,r.kt)("th",{parentName:"tr",align:null},"count"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"2021-05-31T23:45:10.000000Z"),(0,r.kt)("td",{parentName:"tr",align:null},"3")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"2021-06-01T00:45:10.000000Z"),(0,r.kt)("td",{parentName:"tr",align:null},"1")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"2021-05-31T23:45:10.000000Z"),(0,r.kt)("td",{parentName:"tr",align:null},"1")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"2021-06-01T00:45:10.000000Z"),(0,r.kt)("td",{parentName:"tr",align:null},"1")))),(0,r.kt)("p",null,"The following will return the trade volume in 30 minute intervals"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-questdb-sql",metastring:'title="30 minute interval"',title:'"30',minute:!0,'interval"':!0},"SELECT ts, sum(quantity*price) FROM trades SAMPLE BY 30m;\n")),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"ts"),(0,r.kt)("th",{parentName:"tr",align:null},"sum"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"2021-05-31T23:45:10.000000Z"),(0,r.kt)("td",{parentName:"tr",align:null},"1000.5")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"2021-06-01T00:15:10.000000Z"),(0,r.kt)("td",{parentName:"tr",align:null},"16024")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"2021-06-01T00:45:10.000000Z"),(0,r.kt)("td",{parentName:"tr",align:null},"8000")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"2021-06-01T00:15:10.000000Z"),(0,r.kt)("td",{parentName:"tr",align:null},"8012")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"2021-06-01T00:45:10.000000Z"),(0,r.kt)("td",{parentName:"tr",align:null},"8000")))),(0,r.kt)("p",null,"The following will return the average trade notional (where notional is = q ","*","\np) by day:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-questdb-sql",metastring:'title="Daily interval"',title:'"Daily','interval"':!0},"SELECT ts, avg(quantity*price) FROM trades SAMPLE BY 1d;\n")),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"ts"),(0,r.kt)("th",{parentName:"tr",align:null},"avg"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"2021-05-31T23:45:10.000000Z"),(0,r.kt)("td",{parentName:"tr",align:null},"6839.416666666667")))),(0,r.kt)("p",null,"To make this sample align to calendar dates:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-questdb-sql",metastring:'title="Calendar alignment"',title:'"Calendar','alignment"':!0},"SELECT ts, avg(quantity*price) FROM trades SAMPLE BY 1d ALIGN TO CALENDAR;\n")),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"ts"),(0,r.kt)("th",{parentName:"tr",align:null},"avg"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"2021-05-31T00:00:00.000000Z"),(0,r.kt)("td",{parentName:"tr",align:null},"1000.5")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"2021-06-01T00:00:00.000000Z"),(0,r.kt)("td",{parentName:"tr",align:null},"8007.2")))),(0,r.kt)("h2",{id:"see-also"},"See also"),(0,r.kt)("p",null,"This section includes links to additional information such as tutorials."),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("a",{parentName:"li",href:"/blog/2022/11/23/sql-extensions-time-series-data-questdb-part-ii"},(0,r.kt)("inlineCode",{parentName:"a"},"SAMPLE BY")),":\nBlog post focusing on the data analysis ability of ",(0,r.kt)("inlineCode",{parentName:"li"},"SAMPLE BY"))))}o.isMDXComponent=!0},50532:function(t,e){e.Z="data:image/svg+xml;base64,Cgo8c3ZnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgd2lkdGg9IjEwMDAiIGhlaWdodD0iMjAwIj4KICA8ZGVmcz4KICAgIDxzdHlsZSB0eXBlPSJ0ZXh0L2NzcyI+CiAgICAgIEBuYW1lc3BhY2UgImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIjsKICAgICAgLmxpbmUgICAgICAgICAgICAgICAgIHtmaWxsOiBub25lOyBzdHJva2U6ICM2MzYyNzM7fQogICAgICAuYm9sZC1saW5lICAgICAgICAgICAge3N0cm9rZTogIzYzNjI3Mzsgc2hhcGUtcmVuZGVyaW5nOiBjcmlzcEVkZ2VzOyBzdHJva2Utd2lkdGg6IDI7IH0KICAgICAgLnRoaW4tbGluZSAgICAgICAgICAgIHtzdHJva2U6ICM2MzYyNzM7IHNoYXBlLXJlbmRlcmluZzogY3Jpc3BFZGdlc30KICAgICAgLmZpbGxlZCAgICAgICAgICAgICAgIHtmaWxsOiAjNjM2MjczOyBzdHJva2U6IG5vbmU7fQogICAgICB0ZXh0LnRlcm1pbmFsICAgICAgICAge2ZvbnQtZmFtaWx5OiAtYXBwbGUtc3lzdGVtLCBCbGlua01hY1N5c3RlbUZvbnQsICJTZWdvZSBVSSIsIFJvYm90bywgVWJ1bnR1LCBDYW50YXJlbGwsIEhlbHZldGljYSwgc2Fucy1zZXJpZjsKICAgICAgZm9udC1zaXplOiAxMnB4OwogICAgICBmaWxsOiAjZmZmZmZmOwogICAgICBmb250LXdlaWdodDogYm9sZDsKICAgICAgfQogICAgICB0ZXh0Lm5vbnRlcm1pbmFsICAgICAge2ZvbnQtZmFtaWx5OiAtYXBwbGUtc3lzdGVtLCBCbGlua01hY1N5c3RlbUZvbnQsICJTZWdvZSBVSSIsIFJvYm90bywgVWJ1bnR1LCBDYW50YXJlbGwsIEhlbHZldGljYSwgc2Fucy1zZXJpZjsKICAgICAgZm9udC1zaXplOiAxMnB4OwogICAgICBmaWxsOiAjZTI4OWE0OwogICAgICBmb250LXdlaWdodDogbm9ybWFsOwogICAgICB9CiAgICAgIHRleHQucmVnZXhwICAgICAgICAgICB7Zm9udC1mYW1pbHk6IC1hcHBsZS1zeXN0ZW0sIEJsaW5rTWFjU3lzdGVtRm9udCwgIlNlZ29lIFVJIiwgUm9ib3RvLCBVYnVudHUsIENhbnRhcmVsbCwgSGVsdmV0aWNhLCBzYW5zLXNlcmlmOwogICAgICBmb250LXNpemU6IDEycHg7CiAgICAgIGZpbGw6ICMwMDE0MUY7CiAgICAgIGZvbnQtd2VpZ2h0OiBub3JtYWw7CiAgICAgIH0KICAgICAgcmVjdCwgY2lyY2xlLCBwb2x5Z29uIHtmaWxsOiBub25lOyBzdHJva2U6IG5vbmU7fQogICAgICByZWN0LnRlcm1pbmFsICAgICAgICAge2ZpbGw6IG5vbmU7IHN0cm9rZTogI2JlMmY1Yjt9CiAgICAgIHJlY3Qubm9udGVybWluYWwgICAgICB7ZmlsbDogcmdiYSgyNTUsMjU1LDI1NSwwLjEpOyBzdHJva2U6IG5vbmU7fQogICAgICByZWN0LnRleHQgICAgICAgICAgICAge2ZpbGw6IG5vbmU7IHN0cm9rZTogbm9uZTt9CiAgICAgIHBvbHlnb24ucmVnZXhwICAgICAgICB7ZmlsbDogI0M3RUNGRjsgc3Ryb2tlOiAjMDM4Y2JjO30KICAgIDwvc3R5bGU+CiAgICAgICAgIDwvZGVmcz4KICAgICAgICAgPHBvbHlnb24gcG9pbnRzPSI5IDE3IDEgMTMgMSAyMSIvPgogICAgICAgICA8cG9seWdvbiBwb2ludHM9IjE3IDE3IDkgMTMgOSAyMSIvPgogICAgICAgICA8cmVjdCB4PSIzMSIgeT0iMyIgd2lkdGg9IjY0IiBoZWlnaHQ9IjMyIiByeD0iMTAiLz4KICAgICAgICAgPHJlY3QgeD0iMjkiIHk9IjEiIHdpZHRoPSI2NCIgaGVpZ2h0PSIzMiIgY2xhc3M9InRlcm1pbmFsIiByeD0iMTAiLz4KICAgICAgICAgPHRleHQgY2xhc3M9InRlcm1pbmFsIiB4PSIzOSIgeT0iMjEiPkFMSUdOPC90ZXh0PgogICAgICAgICA8cmVjdCB4PSIxMTUiIHk9IjMiIHdpZHRoPSIzOCIgaGVpZ2h0PSIzMiIgcng9IjEwIi8+CiAgICAgICAgIDxyZWN0IHg9IjExMyIgeT0iMSIgd2lkdGg9IjM4IiBoZWlnaHQ9IjMyIiBjbGFzcz0idGVybWluYWwiIHJ4PSIxMCIvPgogICAgICAgICA8dGV4dCBjbGFzcz0idGVybWluYWwiIHg9IjEyMyIgeT0iMjEiPlRPPC90ZXh0PgogICAgICAgICA8cmVjdCB4PSIxOTMiIHk9IjMiIHdpZHRoPSI2MCIgaGVpZ2h0PSIzMiIgcng9IjEwIi8+CiAgICAgICAgIDxyZWN0IHg9IjE5MSIgeT0iMSIgd2lkdGg9IjYwIiBoZWlnaHQ9IjMyIiBjbGFzcz0idGVybWluYWwiIHJ4PSIxMCIvPgogICAgICAgICA8dGV4dCBjbGFzcz0idGVybWluYWwiIHg9IjIwMSIgeT0iMjEiPkZJUlNUPC90ZXh0PgogICAgICAgICA8cmVjdCB4PSIyNzMiIHk9IjMiIHdpZHRoPSIxMjAiIGhlaWdodD0iMzIiIHJ4PSIxMCIvPgogICAgICAgICA8cmVjdCB4PSIyNzEiIHk9IjEiIHdpZHRoPSIxMjAiIGhlaWdodD0iMzIiIGNsYXNzPSJ0ZXJtaW5hbCIgcng9IjEwIi8+CiAgICAgICAgIDx0ZXh0IGNsYXNzPSJ0ZXJtaW5hbCIgeD0iMjgxIiB5PSIyMSI+T0JTRVJWQVRJT048L3RleHQ+CiAgICAgICAgIDxyZWN0IHg9IjE5MyIgeT0iNDciIHdpZHRoPSI5MiIgaGVpZ2h0PSIzMiIgcng9IjEwIi8+CiAgICAgICAgIDxyZWN0IHg9IjE5MSIgeT0iNDUiIHdpZHRoPSI5MiIgaGVpZ2h0PSIzMiIgY2xhc3M9InRlcm1pbmFsIiByeD0iMTAiLz4KICAgICAgICAgPHRleHQgY2xhc3M9InRlcm1pbmFsIiB4PSIyMDEiIHk9IjY1Ij5DQUxFTkRBUjwvdGV4dD4KICAgICAgICAgPHJlY3QgeD0iMzI1IiB5PSI3OSIgd2lkdGg9IjU0IiBoZWlnaHQ9IjMyIiByeD0iMTAiLz4KICAgICAgICAgPHJlY3QgeD0iMzIzIiB5PSI3NyIgd2lkdGg9IjU0IiBoZWlnaHQ9IjMyIiBjbGFzcz0idGVybWluYWwiIHJ4PSIxMCIvPgogICAgICAgICA8dGV4dCBjbGFzcz0idGVybWluYWwiIHg9IjMzMyIgeT0iOTciPlRJTUU8L3RleHQ+CiAgICAgICAgIDxyZWN0IHg9IjM5OSIgeT0iNzkiIHdpZHRoPSI1OCIgaGVpZ2h0PSIzMiIgcng9IjEwIi8+CiAgICAgICAgIDxyZWN0IHg9IjM5NyIgeT0iNzciIHdpZHRoPSI1OCIgaGVpZ2h0PSIzMiIgY2xhc3M9InRlcm1pbmFsIiByeD0iMTAiLz4KICAgICAgICAgPHRleHQgY2xhc3M9InRlcm1pbmFsIiB4PSI0MDciIHk9Ijk3Ij5aT05FPC90ZXh0PjxhIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB4bGluazpocmVmPSIjdGltZXpvbmUiIHhsaW5rOnRpdGxlPSJ0aW1lem9uZSI+CiAgICAgICAgICAgIDxyZWN0IHg9IjQ3NyIgeT0iNzkiIHdpZHRoPSI3OCIgaGVpZ2h0PSIzMiIvPgogICAgICAgICAgICA8cmVjdCB4PSI0NzUiIHk9Ijc3IiB3aWR0aD0iNzgiIGhlaWdodD0iMzIiIGNsYXNzPSJub250ZXJtaW5hbCIvPgogICAgICAgICAgICA8dGV4dCBjbGFzcz0ibm9udGVybWluYWwiIHg9IjQ4NSIgeT0iOTciPnRpbWV6b25lPC90ZXh0PjwvYT48cmVjdCB4PSIzMjUiIHk9IjEyMyIgd2lkdGg9IjU4IiBoZWlnaHQ9IjMyIiByeD0iMTAiLz4KICAgICAgICAgPHJlY3QgeD0iMzIzIiB5PSIxMjEiIHdpZHRoPSI1OCIgaGVpZ2h0PSIzMiIgY2xhc3M9InRlcm1pbmFsIiByeD0iMTAiLz4KICAgICAgICAgPHRleHQgY2xhc3M9InRlcm1pbmFsIiB4PSIzMzMiIHk9IjE0MSI+V0lUSDwvdGV4dD4KICAgICAgICAgPHJlY3QgeD0iNDAzIiB5PSIxMjMiIHdpZHRoPSI3MiIgaGVpZ2h0PSIzMiIgcng9IjEwIi8+CiAgICAgICAgIDxyZWN0IHg9IjQwMSIgeT0iMTIxIiB3aWR0aD0iNzIiIGhlaWdodD0iMzIiIGNsYXNzPSJ0ZXJtaW5hbCIgcng9IjEwIi8+CiAgICAgICAgIDx0ZXh0IGNsYXNzPSJ0ZXJtaW5hbCIgeD0iNDExIiB5PSIxNDEiPk9GRlNFVDwvdGV4dD48YSB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgeGxpbms6aHJlZj0iI29mZnNldCIgeGxpbms6dGl0bGU9Im9mZnNldCI+CiAgICAgICAgICAgIDxyZWN0IHg9IjQ5NSIgeT0iMTIzIiB3aWR0aD0iNTYiIGhlaWdodD0iMzIiLz4KICAgICAgICAgICAgPHJlY3QgeD0iNDkzIiB5PSIxMjEiIHdpZHRoPSI1NiIgaGVpZ2h0PSIzMiIgY2xhc3M9Im5vbnRlcm1pbmFsIi8+CiAgICAgICAgICAgIDx0ZXh0IGNsYXNzPSJub250ZXJtaW5hbCIgeD0iNTAzIiB5PSIxNDEiPm9mZnNldDwvdGV4dD48L2E+PHBhdGggeG1sbnM6c3ZnPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgY2xhc3M9ImxpbmUiIGQ9Im0xNyAxNyBoMiBtMCAwIGgxMCBtNjQgMCBoMTAgbTAgMCBoMTAgbTM4IDAgaDEwIG0yMCAwIGgxMCBtNjAgMCBoMTAgbTAgMCBoMTAgbTEyMCAwIGgxMCBtMCAwIGgxODIgbS00MjIgMCBoMjAgbTQwMiAwIGgyMCBtLTQ0MiAwIHExMCAwIDEwIDEwIG00MjIgMCBxMCAtMTAgMTAgLTEwIG0tNDMyIDEwIHYyNCBtNDIyIDAgdi0yNCBtLTQyMiAyNCBxMCAxMCAxMCAxMCBtNDAyIDAgcTEwIDAgMTAgLTEwIG0tNDEyIDEwIGgxMCBtOTIgMCBoMTAgbTIwIDAgaDEwIG0wIDAgaDI0MCBtLTI3MCAwIGgyMCBtMjUwIDAgaDIwIG0tMjkwIDAgcTEwIDAgMTAgMTAgbTI3MCAwIHEwIC0xMCAxMCAtMTAgbS0yODAgMTAgdjEyIG0yNzAgMCB2LTEyIG0tMjcwIDEyIHEwIDEwIDEwIDEwIG0yNTAgMCBxMTAgMCAxMCAtMTAgbS0yNjAgMTAgaDEwIG01NCAwIGgxMCBtMCAwIGgxMCBtNTggMCBoMTAgbTAgMCBoMTAgbTc4IDAgaDEwIG0tMjYwIC0xMCB2MjAgbTI3MCAwIHYtMjAgbS0yNzAgMjAgdjI0IG0yNzAgMCB2LTI0IG0tMjcwIDI0IHEwIDEwIDEwIDEwIG0yNTAgMCBxMTAgMCAxMCAtMTAgbS0yNjAgMTAgaDEwIG01OCAwIGgxMCBtMCAwIGgxMCBtNzIgMCBoMTAgbTAgMCBoMTAgbTU2IDAgaDEwIG0wIDAgaDQgbTQzIC0xMjAgaC0zIi8+CiAgICAgICAgIDxwb2x5Z29uIHBvaW50cz0iNjEzIDE3IDYyMSAxMyA2MjEgMjEiLz4KICAgICAgICAgPHBvbHlnb24gcG9pbnRzPSI2MTMgMTcgNjA1IDEzIDYwNSAyMSIvPjwvc3ZnPg=="}}]);