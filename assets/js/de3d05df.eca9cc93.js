"use strict";(self.webpackChunkquestdb_io=self.webpackChunkquestdb_io||[]).push([[2523],{3905:function(I,e,g){g.d(e,{Zo:function(){return l},kt:function(){return o}});var i=g(67294);function t(I,e,g){return e in I?Object.defineProperty(I,e,{value:g,enumerable:!0,configurable:!0,writable:!0}):I[e]=g,I}function C(I,e){var g=Object.keys(I);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(I);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(I,e).enumerable}))),g.push.apply(g,i)}return g}function A(I){for(var e=1;e<arguments.length;e++){var g=null!=arguments[e]?arguments[e]:{};e%2?C(Object(g),!0).forEach((function(e){t(I,e,g[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(I,Object.getOwnPropertyDescriptors(g)):C(Object(g)).forEach((function(e){Object.defineProperty(I,e,Object.getOwnPropertyDescriptor(g,e))}))}return I}function n(I,e){if(null==I)return{};var g,i,t=function(I,e){if(null==I)return{};var g,i,t={},C=Object.keys(I);for(i=0;i<C.length;i++)g=C[i],e.indexOf(g)>=0||(t[g]=I[g]);return t}(I,e);if(Object.getOwnPropertySymbols){var C=Object.getOwnPropertySymbols(I);for(i=0;i<C.length;i++)g=C[i],e.indexOf(g)>=0||Object.prototype.propertyIsEnumerable.call(I,g)&&(t[g]=I[g])}return t}var a=i.createContext({}),r=function(I){var e=i.useContext(a),g=e;return I&&(g="function"==typeof I?I(e):A(A({},e),I)),g},l=function(I){var e=r(I.components);return i.createElement(a.Provider,{value:e},I.children)},s={inlineCode:"code",wrapper:function(I){var e=I.children;return i.createElement(i.Fragment,{},e)}},d=i.forwardRef((function(I,e){var g=I.components,t=I.mdxType,C=I.originalType,a=I.parentName,l=n(I,["components","mdxType","originalType","parentName"]),d=r(g),o=t,c=d["".concat(a,".").concat(o)]||d[o]||s[o]||C;return g?i.createElement(c,A(A({ref:e},l),{},{components:g})):i.createElement(c,A({ref:e},l))}));function o(I,e){var g=arguments,t=e&&e.mdxType;if("string"==typeof I||t){var C=g.length,A=new Array(C);A[0]=d;var n={};for(var a in e)hasOwnProperty.call(e,a)&&(n[a]=e[a]);n.originalType=I,n.mdxType="string"==typeof I?I:t,A[1]=n;for(var r=2;r<C;r++)A[r]=g[r];return i.createElement.apply(null,A)}return i.createElement.apply(null,g)}d.displayName="MDXCreateElement"},4691:function(I,e,g){g.r(e),g.d(e,{frontMatter:function(){return n},metadata:function(){return a},toc:function(){return r},default:function(){return s}});var i=g(83117),t=g(80102),C=(g(67294),g(3905)),A=["components"],n={title:"WITH keyword",sidebar_label:"WITH",description:"WITH SQL keyword reference documentation."},a={unversionedId:"reference/sql/with",id:"reference/sql/with",isDocsHomePage:!1,title:"WITH keyword",description:"WITH SQL keyword reference documentation.",source:"@site/docs/reference/sql/with.md",sourceDirName:"reference/sql",slug:"/reference/sql/with",permalink:"/docs/reference/sql/with",editUrl:"https://github.com/turpleio/homepage/edit/main/docs/reference/sql/with.md",version:"current",sidebar_label:"WITH",frontMatter:{title:"WITH keyword",sidebar_label:"WITH",description:"WITH SQL keyword reference documentation."},sidebar:"docs",previous:{title:"WHERE keyword",permalink:"/docs/reference/sql/where"},next:{title:"FAQ",permalink:"/docs/troubleshooting/faq"}},r=[{value:"Syntax",id:"syntax",children:[]},{value:"Examples",id:"examples",children:[]}],l={toc:r};function s(I){var e=I.components,n=(0,t.Z)(I,A);return(0,C.kt)("wrapper",(0,i.Z)({},l,n,{components:e,mdxType:"MDXLayout"}),(0,C.kt)("p",null,"Supports Common Table Expressions (CTEs), e.i., naming one or several\nsub-queries to be used with a ",(0,C.kt)("a",{parentName:"p",href:"/docs/reference/sql/select/"},(0,C.kt)("inlineCode",{parentName:"a"},"SELECT")),",\n",(0,C.kt)("a",{parentName:"p",href:"/docs/reference/sql/insert/"},(0,C.kt)("inlineCode",{parentName:"a"},"INSERT")),", or\n",(0,C.kt)("a",{parentName:"p",href:"/docs/reference/sql/update/"},(0,C.kt)("inlineCode",{parentName:"a"},"UPDATE"))," query."),(0,C.kt)("p",null,"Using a CTE makes it easy to simplify large or complex statements which involve\nsub-queries, particularly when such sub-queries are used several times."),(0,C.kt)("h2",{id:"syntax"},"Syntax"),(0,C.kt)("p",null,(0,C.kt)("img",{alt:"Flow chart showing the syntax of the WITH clause",src:g(82376).Z})),(0,C.kt)("p",null,"Where:"),(0,C.kt)("ul",null,(0,C.kt)("li",{parentName:"ul"},(0,C.kt)("inlineCode",{parentName:"li"},"alias")," is the name given to the sub-query for ease of reusing"),(0,C.kt)("li",{parentName:"ul"},(0,C.kt)("inlineCode",{parentName:"li"},"subQuery")," is a SQL query (e.g ",(0,C.kt)("inlineCode",{parentName:"li"},"SELECT * FROM table"),")")),(0,C.kt)("h2",{id:"examples"},"Examples"),(0,C.kt)("pre",null,(0,C.kt)("code",{parentName:"pre",className:"language-questdb-sql",metastring:'title="Single alias"',title:'"Single','alias"':!0},"WITH first_10_users AS (SELECT * FROM users limit 10)\nSELECT user_name FROM first_10_users;\n")),(0,C.kt)("pre",null,(0,C.kt)("code",{parentName:"pre",className:"language-questdb-sql",metastring:'title="Using recursively"',title:'"Using','recursively"':!0},"WITH first_10_users AS (SELECT * FROM users limit 10),\nfirst_5_users AS (SELECT * FROM first_10_users limit 5)\nSELECT user_name FROM first_5_users;\n")),(0,C.kt)("pre",null,(0,C.kt)("code",{parentName:"pre",className:"language-questdb-sql",metastring:'title="Flag whether individual trips are longer or shorter than average"',title:'"Flag',whether:!0,individual:!0,trips:!0,are:!0,longer:!0,or:!0,shorter:!0,than:!0,'average"':!0},"WITH avg_distance AS (SELECT avg(trip_distance) average FROM trips)\nSELECT pickup_datetime, trips.trip_distance > avg_distance.average longer_than_average\nFROM trips CROSS JOIN avg_distance;\n")),(0,C.kt)("pre",null,(0,C.kt)("code",{parentName:"pre",className:"language-questdb-sql",metastring:'title="Update with a sub-query"',title:'"Update',with:!0,a:!0,'sub-query"':!0},"WITH up AS (\n    SELECT symbol, spread, ts\n    FROM temp_spreads\n    WHERE timestamp between '2022-01-02' and '2022-01-03'\n)\nUPDATE spreads s\nSET spread = up.spread\nFROM up\nWHERE up.ts = s.ts AND s.symbol = up.symbol;\n")),(0,C.kt)("pre",null,(0,C.kt)("code",{parentName:"pre",className:"language-questdb-sql",metastring:'title="Insert with a sub-query"',title:'"Insert',with:!0,a:!0,'sub-query"':!0},"WITH up AS (\n    SELECT symbol, spread, ts\n    FROM temp_spreads\n    WHERE timestamp between '2022-01-02' and '2022-01-03'\n)\nINSERT INTO spreads\nSELECT * FROM up;\n")))}s.isMDXComponent=!0},82376:function(I,e){e.Z="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI2NTEiIGhlaWdodD0iMTcwIj4KICAgIDxkZWZzPgogICAgICAgIDxzdHlsZSB0eXBlPSJ0ZXh0L2NzcyI+CiAgICAgICAgICAgIEBuYW1lc3BhY2UgImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIjsKICAgICAgICAgICAgLmxpbmUgICAgICAgICAgICAgICAgIHtmaWxsOiBub25lOyBzdHJva2U6ICM2MzYyNzM7fQogICAgICAgICAgICAuYm9sZC1saW5lICAgICAgICAgICAge3N0cm9rZTogIzYzNjI3Mzsgc2hhcGUtcmVuZGVyaW5nOiBjcmlzcEVkZ2VzOyBzdHJva2Utd2lkdGg6IDI7IH0KICAgICAgICAgICAgLnRoaW4tbGluZSAgICAgICAgICAgIHtzdHJva2U6ICM2MzYyNzM7IHNoYXBlLXJlbmRlcmluZzogY3Jpc3BFZGdlc30KICAgICAgICAgICAgLmZpbGxlZCAgICAgICAgICAgICAgIHtmaWxsOiAjNjM2MjczOyBzdHJva2U6IG5vbmU7fQogICAgICAgICAgICB0ZXh0LnRlcm1pbmFsICAgICAgICAge2ZvbnQtZmFtaWx5OiAtYXBwbGUtc3lzdGVtLCBCbGlua01hY1N5c3RlbUZvbnQsICJTZWdvZSBVSSIsIFJvYm90bywgVWJ1bnR1LCBDYW50YXJlbGwsIEhlbHZldGljYSwgc2Fucy1zZXJpZjsKICAgICAgICAgICAgZm9udC1zaXplOiAxMnB4OwogICAgICAgICAgICBmaWxsOiAjZmZmZmZmOwogICAgICAgICAgICBmb250LXdlaWdodDogYm9sZDsKICAgICAgICAgICAgfQogICAgICAgICAgICB0ZXh0Lm5vbnRlcm1pbmFsICAgICAge2ZvbnQtZmFtaWx5OiAtYXBwbGUtc3lzdGVtLCBCbGlua01hY1N5c3RlbUZvbnQsICJTZWdvZSBVSSIsIFJvYm90bywgVWJ1bnR1LCBDYW50YXJlbGwsIEhlbHZldGljYSwgc2Fucy1zZXJpZjsKICAgICAgICAgICAgZm9udC1zaXplOiAxMnB4OwogICAgICAgICAgICBmaWxsOiAjZTI4OWE0OwogICAgICAgICAgICBmb250LXdlaWdodDogbm9ybWFsOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHRleHQucmVnZXhwICAgICAgICAgICB7Zm9udC1mYW1pbHk6IC1hcHBsZS1zeXN0ZW0sIEJsaW5rTWFjU3lzdGVtRm9udCwgIlNlZ29lIFVJIiwgUm9ib3RvLCBVYnVudHUsIENhbnRhcmVsbCwgSGVsdmV0aWNhLCBzYW5zLXNlcmlmOwogICAgICAgICAgICBmb250LXNpemU6IDEycHg7CiAgICAgICAgICAgIGZpbGw6ICMwMDE0MUY7CiAgICAgICAgICAgIGZvbnQtd2VpZ2h0OiBub3JtYWw7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmVjdCwgY2lyY2xlLCBwb2x5Z29uIHtmaWxsOiBub25lOyBzdHJva2U6IG5vbmU7fQogICAgICAgICAgICByZWN0LnRlcm1pbmFsICAgICAgICAge2ZpbGw6IG5vbmU7IHN0cm9rZTogI2JlMmY1Yjt9CiAgICAgICAgICAgIHJlY3Qubm9udGVybWluYWwgICAgICB7ZmlsbDogcmdiYSgyNTUsMjU1LDI1NSwwLjEpOyBzdHJva2U6IG5vbmU7fQogICAgICAgICAgICByZWN0LnRleHQgICAgICAgICAgICAge2ZpbGw6IG5vbmU7IHN0cm9rZTogbm9uZTt9CiAgICAgICAgICAgIHBvbHlnb24ucmVnZXhwICAgICAgICB7ZmlsbDogI0M3RUNGRjsgc3Ryb2tlOiAjMDM4Y2JjO30KICAgICAgICA8L3N0eWxlPgogICAgICAgIDwvZGVmcz4KICAgICAgICAgPHBvbHlnb24gcG9pbnRzPSI5IDYxIDEgNTcgMSA2NSIvPgogICAgICAgICA8cG9seWdvbiBwb2ludHM9IjE3IDYxIDkgNTcgOSA2NSIvPgogICAgICAgICA8cmVjdCB4PSIzMSIgeT0iNDciIHdpZHRoPSI1OCIgaGVpZ2h0PSIzMiIgcng9IjEwIi8+CiAgICAgICAgIDxyZWN0IHg9IjI5IiB5PSI0NSIgd2lkdGg9IjU4IiBoZWlnaHQ9IjMyIiBjbGFzcz0idGVybWluYWwiIHJ4PSIxMCIvPgogICAgICAgICA8dGV4dCBjbGFzcz0idGVybWluYWwiIHg9IjM5IiB5PSI2NSI+V0lUSDwvdGV4dD48YSB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgeGxpbms6aHJlZj0iI2FsaWFzIiB4bGluazp0aXRsZT0iYWxpYXMiPgogICAgICAgICAgICA8cmVjdCB4PSIxMjkiIHk9IjQ3IiB3aWR0aD0iNTAiIGhlaWdodD0iMzIiLz4KICAgICAgICAgICAgPHJlY3QgeD0iMTI3IiB5PSI0NSIgd2lkdGg9IjUwIiBoZWlnaHQ9IjMyIiBjbGFzcz0ibm9udGVybWluYWwiLz4KICAgICAgICAgICAgPHRleHQgY2xhc3M9Im5vbnRlcm1pbmFsIiB4PSIxMzciIHk9IjY1Ij5hbGlhczwvdGV4dD48L2E+PHJlY3QgeD0iMTk5IiB5PSI0NyIgd2lkdGg9IjM4IiBoZWlnaHQ9IjMyIiByeD0iMTAiLz4KICAgICAgICAgPHJlY3QgeD0iMTk3IiB5PSI0NSIgd2lkdGg9IjM4IiBoZWlnaHQ9IjMyIiBjbGFzcz0idGVybWluYWwiIHJ4PSIxMCIvPgogICAgICAgICA8dGV4dCBjbGFzcz0idGVybWluYWwiIHg9IjIwNyIgeT0iNjUiPkFTPC90ZXh0PgogICAgICAgICA8cmVjdCB4PSIyNTciIHk9IjQ3IiB3aWR0aD0iMjYiIGhlaWdodD0iMzIiIHJ4PSIxMCIvPgogICAgICAgICA8cmVjdCB4PSIyNTUiIHk9IjQ1IiB3aWR0aD0iMjYiIGhlaWdodD0iMzIiIGNsYXNzPSJ0ZXJtaW5hbCIgcng9IjEwIi8+CiAgICAgICAgIDx0ZXh0IGNsYXNzPSJ0ZXJtaW5hbCIgeD0iMjY1IiB5PSI2NSI+KDwvdGV4dD48YSB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgeGxpbms6aHJlZj0iI3N1YlF1ZXJ5IiB4bGluazp0aXRsZT0ic3ViUXVlcnkiPgogICAgICAgICAgICA8cmVjdCB4PSIzMDMiIHk9IjQ3IiB3aWR0aD0iODAiIGhlaWdodD0iMzIiLz4KICAgICAgICAgICAgPHJlY3QgeD0iMzAxIiB5PSI0NSIgd2lkdGg9IjgwIiBoZWlnaHQ9IjMyIiBjbGFzcz0ibm9udGVybWluYWwiLz4KICAgICAgICAgICAgPHRleHQgY2xhc3M9Im5vbnRlcm1pbmFsIiB4PSIzMTEiIHk9IjY1Ij5zdWJRdWVyeTwvdGV4dD48L2E+PHJlY3QgeD0iNDAzIiB5PSI0NyIgd2lkdGg9IjI2IiBoZWlnaHQ9IjMyIiByeD0iMTAiLz4KICAgICAgICAgPHJlY3QgeD0iNDAxIiB5PSI0NSIgd2lkdGg9IjI2IiBoZWlnaHQ9IjMyIiBjbGFzcz0idGVybWluYWwiIHJ4PSIxMCIvPgogICAgICAgICA8dGV4dCBjbGFzcz0idGVybWluYWwiIHg9IjQxMSIgeT0iNjUiPik8L3RleHQ+CiAgICAgICAgIDxyZWN0IHg9IjEyOSIgeT0iMyIgd2lkdGg9IjI0IiBoZWlnaHQ9IjMyIiByeD0iMTAiLz4KICAgICAgICAgPHJlY3QgeD0iMTI3IiB5PSIxIiB3aWR0aD0iMjQiIGhlaWdodD0iMzIiIGNsYXNzPSJ0ZXJtaW5hbCIgcng9IjEwIi8+CiAgICAgICAgIDx0ZXh0IGNsYXNzPSJ0ZXJtaW5hbCIgeD0iMTM3IiB5PSIyMSI+LDwvdGV4dD4KICAgICAgICAgPHJlY3QgeD0iNDg5IiB5PSI0NyIgd2lkdGg9IjcwIiBoZWlnaHQ9IjMyIiByeD0iMTAiLz4KICAgICAgICAgPHJlY3QgeD0iNDg3IiB5PSI0NSIgd2lkdGg9IjcwIiBoZWlnaHQ9IjMyIiBjbGFzcz0idGVybWluYWwiIHJ4PSIxMCIvPgogICAgICAgICA8dGV4dCBjbGFzcz0idGVybWluYWwiIHg9IjQ5NyIgeT0iNjUiPlNFTEVDVDwvdGV4dD4KICAgICAgICAgPHJlY3QgeD0iNDg5IiB5PSI5MSIgd2lkdGg9Ijc0IiBoZWlnaHQ9IjMyIiByeD0iMTAiLz4KICAgICAgICAgPHJlY3QgeD0iNDg3IiB5PSI4OSIgd2lkdGg9Ijc0IiBoZWlnaHQ9IjMyIiBjbGFzcz0idGVybWluYWwiIHJ4PSIxMCIvPgogICAgICAgICA8dGV4dCBjbGFzcz0idGVybWluYWwiIHg9IjQ5NyIgeT0iMTA5Ij5VUERBVEU8L3RleHQ+CiAgICAgICAgIDxyZWN0IHg9IjQ4OSIgeT0iMTM1IiB3aWR0aD0iNzAiIGhlaWdodD0iMzIiIHJ4PSIxMCIvPgogICAgICAgICA8cmVjdCB4PSI0ODciIHk9IjEzMyIgd2lkdGg9IjcwIiBoZWlnaHQ9IjMyIiBjbGFzcz0idGVybWluYWwiIHJ4PSIxMCIvPgogICAgICAgICA8dGV4dCBjbGFzcz0idGVybWluYWwiIHg9IjQ5NyIgeT0iMTUzIj5JTlNFUlQ8L3RleHQ+CiAgICAgICAgIDxwYXRoIHhtbG5zOnN2Zz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGNsYXNzPSJsaW5lIiBkPSJtMTcgNjEgaDIgbTAgMCBoMTAgbTU4IDAgaDEwIG0yMCAwIGgxMCBtNTAgMCBoMTAgbTAgMCBoMTAgbTM4IDAgaDEwIG0wIDAgaDEwIG0yNiAwIGgxMCBtMCAwIGgxMCBtODAgMCBoMTAgbTAgMCBoMTAgbTI2IDAgaDEwIG0tMzQwIDAgbDIwIDAgbS0xIDAgcS05IDAgLTkgLTEwIGwwIC0yNCBxMCAtMTAgMTAgLTEwIG0zMjAgNDQgbDIwIDAgbS0yMCAwIHExMCAwIDEwIC0xMCBsMCAtMjQgcTAgLTEwIC0xMCAtMTAgbS0zMjAgMCBoMTAgbTI0IDAgaDEwIG0wIDAgaDI3NiBtNDAgNDQgaDEwIG03MCAwIGgxMCBtMCAwIGg0IG0tMTE0IDAgaDIwIG05NCAwIGgyMCBtLTEzNCAwIHExMCAwIDEwIDEwIG0xMTQgMCBxMCAtMTAgMTAgLTEwIG0tMTI0IDEwIHYyNCBtMTE0IDAgdi0yNCBtLTExNCAyNCBxMCAxMCAxMCAxMCBtOTQgMCBxMTAgMCAxMCAtMTAgbS0xMDQgMTAgaDEwIG03NCAwIGgxMCBtLTEwNCAtMTAgdjIwIG0xMTQgMCB2LTIwIG0tMTE0IDIwIHYyNCBtMTE0IDAgdi0yNCBtLTExNCAyNCBxMCAxMCAxMCAxMCBtOTQgMCBxMTAgMCAxMCAtMTAgbS0xMDQgMTAgaDEwIG03MCAwIGgxMCBtMCAwIGg0IG0yMyAtODggaC0zIi8+CiAgICAgICAgIDxwb2x5Z29uIHBvaW50cz0iNjAxIDYxIDYwOSA1NyA2MDkgNjUiLz4KICAgICAgICAgPHBvbHlnb24gcG9pbnRzPSI2MDEgNjEgNTkzIDU3IDU5MyA2NSIvPjwvc3ZnPg=="}}]);